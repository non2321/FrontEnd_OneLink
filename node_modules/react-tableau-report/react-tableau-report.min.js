/*! For license information please see react-tableau-report.min.js.LICENSE */
module.exports=function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var i={};return t.m=e,t.c=i,t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i(1),_=n(u),c=i(2),m=n(c),h=i(3),p=i(4),d=n(p),f={filters:u.PropTypes.object,url:u.PropTypes.string,parameters:u.PropTypes.object,options:u.PropTypes.object,token:u.PropTypes.string},g={loading:!1,parameters:{},filters:{},options:{}},v=function(e){function t(e){r(this,t);var i=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.state={filters:e.filters,parameters:e.parameters,currentUrl:e.url},i}return o(t,e),l(t,[{key:"componentDidMount",value:function(){this.initTableau()}},{key:"componentWillReceiveProps",value:function(e){var t=e.url!==this.state.currentUrl,i=!(0,h.shallowequal)(this.props.filters,e.filters),n=!(0,h.shallowequal)(this.props.parameters,e.parameters),r=this.state.loading;t&&(this.state.currentUrl=e.url,this.forceUpdate(),this.initTableau()),t||!i||r||this.applyFilters(e.filters),t||!n||r||this.applyParameters(e.parameters)}},{key:"getUrl",value:function(){var e=m.default.parse(this.props.url,!0),t=e.protocol+"//"+e.host;return this.props.token&&(t+="/trusted/"+this.props.token),t+=e.pathname+"?:embed=yes&:comments=no&:toolbar=yes&:refresh=yes"}},{key:"applyFilters",value:function(e){var t=this,i=d.default.FilterUpdateType.REPLACE,n=[];this.setState({loading:!0});for(var r in e)this.state.filters.hasOwnProperty(r)&&(0,h.shallowequal)(this.state.filters[r],e[r])||n.push(this.sheet.applyFilterAsync(r,e[r],i));Promise.all(n).then(function(){t.setState({loading:!1,filters:e})})}},{key:"applyParameters",value:function(e){var t=this,i=[];for(var n in e)if(!this.state.parameters.hasOwnProperty(n)||this.state.parameters[n]!==e[n]){var r=e[n];i.push(this.workbook.changeParameterValueAsync(n,r))}Promise.all(i).then(function(){return t.setState({loading:!1,parameters:e})})}},{key:"initTableau",value:function(){var e=this,t=this.getUrl(),i=s({},this.props.filters,this.props.parameters,this.props.options,{onFirstInteractive:function(){e.workbook=e.viz.getWorkbook(),e.sheets=e.workbook.getActiveSheet().getWorksheets(),e.sheet=e.sheets[0]}});this.viz&&(this.viz.dispose(),this.viz=null),this.viz=new d.default.Viz(this.container,t,i)}},{key:"render",value:function(){var e=this;return _.default.createElement("div",{ref:function(t){return e.container=t}})}}]),t}(u.Component);v.propTypes=f,v.defaultProps=g,t.default=v},function(e,t){e.exports=require("react")},function(e,t){e.exports=require("url")},function(e,t,i){"use strict";function n(e,t){var i=e.length;if(i!==t.length)return!1;for(var n=0;n<i;n++)if(e[n]!==t[n])return!1;return!0}function r(e,t){var i=Object.keys(e),n=i.length;if(n!==Object.keys(t).length.length)return!1;for(var r=0;r<n;r++)if(e[i[r]]!==t[i[r]])return!1;return!0}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.shallowequal=function(e,t){return e===t||(Array.isArray(e)&&Array.isArray(t)?n(e,t):"object"===(void 0===e?"undefined":a(e))&&"object"===(void 0===t?"undefined":a(t))&&r(e,t))}},function(e,t,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r={};!function(){function e(e){if(e.__basePrototypePending){var t=e.__baseType;t.__basePrototypePending&&t.__setupBase();for(var i in t.prototype){var n=t.prototype[i];e.prototype[i]||(e.prototype[i]=n)}delete e.__basePrototypePending,delete e.__setupBase}}function t(e,t,i){e.__basePrototypePending&&e.__setupBase(),i?e.__baseType.apply(t,i):e.__baseType.apply(t)}function i(e,t,i,n){var r=e.__baseType.prototype[i];return n?r.apply(t,n):r.apply(t)}var a={version:"0.7.4.0",isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null===e||void 0===e},isValue:function(e){return null!==e&&void 0!==e}};Object.keys||(Object.keys=function(e){var t=[];for(var i in e)t.push(i);return t});var o=Function,s={registerNamespace:{isPrototype:!1,func:o.registerNamespace},registerInterface:{isPrototype:!0,func:o.prototype.registerInterface},registerClass:{isPrototype:!0,func:o.prototype.registerClass},registerEnum:{isPrototype:!0,func:o.prototype.registerEnum}},l={};o.registerNamespace=function(e){},o.prototype.registerInterface=function(e){},o.prototype.registerEnum=function(e,t){for(var i in this.prototype)this[i]=this.prototype[i]},o.prototype.registerClass=function(n,r,a){var o=this;this.prototype.constructor=this,this.__baseType=r||Object,r&&(this.__basePrototypePending=!0,this.__setupBase=function(){e(o)},this.initializeBase=function(e,i){t(o,e,i)},this.callBaseMethod=function(e,t,n){i(o,e,t,n)})},a.Delegate=function(){},a.Delegate.registerClass("Delegate"),a.Delegate.empty=function(){},a.Delegate._contains=function(e,t,i){for(var n=0;n<e.length;n+=2)if(e[n]===t&&e[n+1]===i)return!0;return!1},a.Delegate._create=function(e){var t=function(){if(2==e.length)return e[1].apply(e[0],arguments);for(var t=e.concat(),i=0;i<t.length;i+=2)a.Delegate._contains(e,t[i],t[i+1])&&t[i+1].apply(t[i],arguments);return null};return t._targets=e,t},a.Delegate.create=function(e,t){return e?a.Delegate._create([e,t]):t},a.Delegate.combine=function(e,t){if(!e)return t._targets?t:a.Delegate.create(null,t);if(!t)return e._targets?e:a.Delegate.create(null,e);var i=e._targets?e._targets:[null,e],n=t._targets?t._targets:[null,t];return a.Delegate._create(i.concat(n))},a.Delegate.remove=function(e,t){if(!e||e===t)return null;if(!t)return e;var i,n=e._targets,r=null;t._targets?(r=t._targets[0],i=t._targets[1]):i=t;for(var o=0;o<n.length;o+=2)if(n[o]===r&&n[o+1]===i)return 2==n.length?null:(n.splice(o,2),a.Delegate._create(n));return e},a.IEnumerator=function(){},a.IEnumerator.prototype={get_current:null,moveNext:null,reset:null},a.IEnumerator.getEnumerator=function(e){return e?e.getEnumerator?e.getEnumerator():new a.ArrayEnumerator(e):null},a.IEnumerable=function(){},a.IEnumerable.prototype={getEnumerator:null},a.ArrayEnumerator=function(e){this._array=e,this._index=-1,this.current=null},a.ArrayEnumerator.prototype={moveNext:function(){return this._index++,this.current=this._array[this._index],this._index<this._array.length},reset:function(){this._index=-1,this.current=null}},a.IDisposable=function(){},a.IDisposable.prototype={dispose:null},a.StringBuilder=function(e){this._parts=a.isNullOrUndefined(e)?[]:[e],this.isEmpty=0==this._parts.length},a.StringBuilder.prototype={append:function(e){return a.isNullOrUndefined(e)||(this._parts.push(e),this.isEmpty=!1),this},appendLine:function(e){return this.append(e),this.append("\r\n"),this.isEmpty=!1,this},clear:function(){this._parts=[],this.isEmpty=!0},toString:function(e){return this._parts.join(e||"")}},a.StringBuilder.registerClass("StringBuilder"),a.EventArgs=function(){},a.EventArgs.registerClass("EventArgs"),a.EventArgs.Empty=new a.EventArgs,a.CancelEventArgs=function(){a.CancelEventArgs.initializeBase(this),this.cancel=!1},a.CancelEventArgs.registerClass("CancelEventArgs",a.EventArgs),a.Tuple=function(e,t,i){this.first=e,this.second=t,3==arguments.length&&(this.third=i)},a.Tuple.registerClass("Tuple"),o.registerNamespace("tab"),l.EscapingUtil=function(){},l.EscapingUtil.escapeHtml=function(e){var t=e||"";return t=t.replace(new RegExp("&","g"),"&amp;"),t=t.replace(new RegExp("<","g"),"&lt;"),t=t.replace(new RegExp(">","g"),"&gt;"),t=t.replace(new RegExp('"',"g"),"&quot;"),t=t.replace(new RegExp("'","g"),"&#39;"),t=t.replace(new RegExp("/","g"),"&#47;")},l.WindowHelper=function(e){this._window=e},l.WindowHelper.get_windowSelf=function(){return window.self},l.WindowHelper.close=function(e){e.close()},l.WindowHelper.getOpener=function(e){return e.opener},l.WindowHelper.getLocation=function(e){return e.location},l.WindowHelper.getPathAndSearch=function(e){return e.location.pathname+e.location.search},l.WindowHelper.setLocationHref=function(e,t){e.location.href=t},l.WindowHelper.locationReplace=function(e,t){e.location.replace(t)},l.WindowHelper.open=function(e,t,i){return window.open(e,t,i)},l.WindowHelper.reload=function(e,t){e.location.reload(t)},l.WindowHelper.requestAnimationFrame=function(e){return l.WindowHelper._requestAnimationFrameFunc(e)},l.WindowHelper.cancelAnimationFrame=function(e){a.isValue(e)&&l.WindowHelper._cancelAnimationFrameFunc(e)},l.WindowHelper._setDefaultRequestAnimationFrameImpl=function(){var e=0;l.WindowHelper._requestAnimationFrameFunc=function(t){var i=(new Date).getTime(),n=Math.max(0,16-(i-e));return e=i+n,window.setTimeout(function(){t()},n)}},l.WindowHelper.prototype={_window:null,get_pageXOffset:function(){return l.WindowHelper._pageXOffsetFunc(this._window)},get_pageYOffset:function(){return l.WindowHelper._pageYOffsetFunc(this._window)},get_clientWidth:function(){return l.WindowHelper._clientWidthFunc(this._window)},get_clientHeight:function(){return l.WindowHelper._clientHeightFunc(this._window)},get_innerWidth:function(){return l.WindowHelper._innerWidthFunc(this._window)},get_outerWidth:function(){return l.WindowHelper._outerWidthFunc(this._window)},get_innerHeight:function(){return l.WindowHelper._innerHeightFunc(this._window)},get_outerHeight:function(){return l.WindowHelper._outerHeightFunc(this._window)},get_screenLeft:function(){return l.WindowHelper._screenLeftFunc(this._window)},get_screenTop:function(){return l.WindowHelper._screenTopFunc(this._window)}},l.EscapingUtil.registerClass("tab.EscapingUtil"),l.WindowHelper.registerClass("tab.WindowHelper"),l.WindowHelper._innerWidthFunc=null,l.WindowHelper._innerHeightFunc=null,l.WindowHelper._clientWidthFunc=null,l.WindowHelper._clientHeightFunc=null,l.WindowHelper._pageXOffsetFunc=null,l.WindowHelper._pageYOffsetFunc=null,l.WindowHelper._screenLeftFunc=null,l.WindowHelper._screenTopFunc=null,l.WindowHelper._outerWidthFunc=null,l.WindowHelper._outerHeightFunc=null,l.WindowHelper._requestAnimationFrameFunc=null,l.WindowHelper._cancelAnimationFrameFunc=null,function(){"innerWidth"in window?l.WindowHelper._innerWidthFunc=function(e){return e.innerWidth}:l.WindowHelper._innerWidthFunc=function(e){return e.document.documentElement.offsetWidth},"outerWidth"in window?l.WindowHelper._outerWidthFunc=function(e){return e.outerWidth}:l.WindowHelper._outerWidthFunc=l.WindowHelper._innerWidthFunc,"innerHeight"in window?l.WindowHelper._innerHeightFunc=function(e){return e.innerHeight}:l.WindowHelper._innerHeightFunc=function(e){return e.document.documentElement.offsetHeight},"outerHeight"in window?l.WindowHelper._outerHeightFunc=function(e){return e.outerHeight}:l.WindowHelper._outerHeightFunc=l.WindowHelper._innerHeightFunc,"clientWidth"in window?l.WindowHelper._clientWidthFunc=function(e){return e.clientWidth}:l.WindowHelper._clientWidthFunc=function(e){return e.document.documentElement.clientWidth},"clientHeight"in window?l.WindowHelper._clientHeightFunc=function(e){return e.clientHeight}:l.WindowHelper._clientHeightFunc=function(e){return e.document.documentElement.clientHeight},a.isValue(window.self.pageXOffset)?l.WindowHelper._pageXOffsetFunc=function(e){return e.pageXOffset}:l.WindowHelper._pageXOffsetFunc=function(e){return e.document.documentElement.scrollLeft},a.isValue(window.self.pageYOffset)?l.WindowHelper._pageYOffsetFunc=function(e){return e.pageYOffset}:l.WindowHelper._pageYOffsetFunc=function(e){return e.document.documentElement.scrollTop},"screenLeft"in window?l.WindowHelper._screenLeftFunc=function(e){return e.screenLeft}:l.WindowHelper._screenLeftFunc=function(e){return e.screenX},"screenTop"in window?l.WindowHelper._screenTopFunc=function(e){return e.screenTop}:l.WindowHelper._screenTopFunc=function(e){return e.screenY};var e=["ms","moz","webkit","o"],t=null,i=null;"requestAnimationFrame"in window&&(t="requestAnimationFrame"),"cancelAnimationFrame"in window&&(i="cancelAnimationFrame");for(var n=0;n<e.length&&(null==t||null==i);++n){var r=e[n],o=r+"RequestAnimationFrame";null==t&&o in window&&(t=o),null==i&&(o=r+"CancelAnimationFrame",o in window&&(i=o),(o=r+"CancelRequestAnimationFrame")in window&&(i=o))}null!=t?l.WindowHelper._requestAnimationFrameFunc=function(e){return window[t](e)}:l.WindowHelper._setDefaultRequestAnimationFrameImpl(),l.WindowHelper._cancelAnimationFrameFunc=null!=i?function(e){window[i](e)}:function(e){window.clearTimeout(e)}}(),o.registerNamespace("tab"),l.$create__SheetInfoImpl=function(e,t,i,n,r,a,o,s,l){var u={};return u.name=e,u.sheetType=t,u.index=i,u.size=n,u.workbook=r,u.url=a,u.isActive=o,u.isHidden=s,u.zoneId=l,u},l.$create__dashboardZoneInfo=function(e,t,i,n,r){var a={};return a._name=e,a._objectType=t,a._position=i,a._size=n,a._zoneId=r,a},l.$create__StoryPointInfoImpl=function(e,t,i,n,r,a){var o={};return o.caption=e,o.index=t,o.storyPointId=i,o.isActive=n,o.isUpdated=r,o.parentStoryImpl=a,o},l._ApiCommand=function(e,t,i,n){this._name=e,this._sourceId=t,this._handlerId=i,this._parameters=n},l._ApiCommand.parse=function(e){var t,i=e.indexOf(",");if(i<0)return t=e,new l._ApiCommand(t,null,null,null);t=e.substr(0,i);var n,r=e.substr(i+1);if((i=r.indexOf(","))<0)return n=r,new l._ApiCommand(t,n,null,null);n=r.substr(0,i);var a,o=r.substr(i+1);if((i=o.indexOf(","))<0)return a=o,new l._ApiCommand(t,n,a,null);a=o.substr(0,i);var s=o.substr(i+1);return l._ApiCommand.lastResponseMessage=e,"api.GetClientInfoCommand"===t&&(l._ApiCommand.lastClientInfoResponseMessage=e),new l._ApiCommand(t,n,a,s)},l._ApiCommand.prototype={_name:null,_handlerId:null,_sourceId:null,_parameters:null,get_name:function(){return this._name},get_handlerId:function(){return this._handlerId},get_sourceId:function(){return this._sourceId},get_parameters:function(){return this._parameters},get_isApiCommandName:function(){return!this.get_rawName().indexOf("api.",0)},get_rawName:function(){return this._name},serialize:function(){var e=[];e.push(this._name),e.push(this._sourceId),e.push(this._handlerId),a.isValue(this._parameters)&&e.push(this._parameters);var t=e.join(",");return l._ApiCommand.lastRequestMessage=t,t}},l._ApiServerResultParser=function(e){var t=JSON.parse(e);this._commandResult=t["api.commandResult"],this._commandData=t["api.commandData"]},l._ApiServerResultParser.prototype={_commandResult:null,_commandData:null,get_result:function(){return this._commandResult},get_data:function(){return this._commandData}},l._ApiServerNotification=function(e,t,i){this._workbookName=e,this._worksheetName=t,this._data=i},l._ApiServerNotification.deserialize=function(e){var t=JSON.parse(e),i=t["api.workbookName"],n=t["api.worksheetName"],r=t["api.commandData"];return new l._ApiServerNotification(i,n,r)},l._ApiServerNotification.prototype={_workbookName:null,_worksheetName:null,_data:null,get_workbookName:function(){return this._workbookName},get_worksheetName:function(){return this._worksheetName},get_data:function(){return this._data},serialize:function(){var e={};return e["api.workbookName"]=this._workbookName,e["api.worksheetName"]=this._worksheetName,e["api.commandData"]=this._data,JSON.stringify(e)}},l._CommandReturnHandler=function(e,t,i,n){this._commandName=e,this._successCallback=i,this._successCallbackTiming=t,this._errorCallback=n},l._CommandReturnHandler.prototype={_commandName:null,_successCallbackTiming:0,_successCallback:null,_errorCallback:null,get_commandName:function(){return this._commandName},get_successCallback:function(){return this._successCallback},get_successCallbackTiming:function(){return this._successCallbackTiming},get_errorCallback:function(){return this._errorCallback}},l._crossDomainMessageRouter=function(){this._handlers={},this._commandCallbacks={},this._customViewLoadCallbacks={},this._commandReturnAfterStateReadyQueues={},l._Utility.hasWindowAddEventListener()?window.addEventListener("message",this._getHandleCrossDomainMessageDelegate(),!1):l._Utility.hasDocumentAttachEvent()?(document.attachEvent("onmessage",this._getHandleCrossDomainMessageDelegate()),window.attachEvent("onmessage",this._getHandleCrossDomainMessageDelegate())):window.onmessage=this._getHandleCrossDomainMessageDelegate(),this._nextHandlerId=this._nextCommandId=0},l._crossDomainMessageRouter.prototype={_nextHandlerId:0,_nextCommandId:0,registerHandler:function(e){var t="handler"+this._nextHandlerId;if(a.isValue(e.get_handlerId())||a.isValue(this._handlers[e.get_handlerId()]))throw l._TableauException.createInternalError("Handler '"+e.get_handlerId()+"' is already registered.");this._nextHandlerId++,e.set_handlerId(t),this._handlers[t]=e,e.add_customViewsListLoad(a.Delegate.create(this,this._handleCustomViewsListLoad)),e.add_stateReadyForQuery(a.Delegate.create(this,this._handleStateReadyForQuery))},unregisterHandler:function(e){(a.isValue(e.get_handlerId())||a.isValue(this._handlers[e.get_handlerId()]))&&(delete this._handlers[e.get_handlerId()],e.remove_customViewsListLoad(a.Delegate.create(this,this._handleCustomViewsListLoad)),e.remove_stateReadyForQuery(a.Delegate.create(this,this._handleStateReadyForQuery)))},sendCommand:function(e,t,i){var n=e.get_iframe(),r=e.get_handlerId();if(l._Utility.hasWindowPostMessage()&&!a.isNullOrUndefined(n)&&!a.isNullOrUndefined(n.contentWindow)){var o="cmd"+this._nextCommandId;this._nextCommandId++;var s=this._commandCallbacks[r];a.isNullOrUndefined(s)&&(s={},this._commandCallbacks[r]=s),s[o]=i;var u=i.get_commandName();if("api.ShowCustomViewCommand"===u){var _=this._customViewLoadCallbacks[r];a.isNullOrUndefined(_)&&(_={},this._customViewLoadCallbacks[r]=_),_[o]=i}var c=null;a.isValue(t)&&(c=l.JsonUtil.toJson(t,!1,""));var m=new l._ApiCommand(u,o,r,c),h=m.serialize();l._Utility.isPostMessageSynchronous()?window.setTimeout(function(){n.contentWindow.postMessage(h,e.get_serverRoot())},0):n.contentWindow.postMessage(h,e.get_serverRoot())}},_handleCustomViewsListLoad:function(e){var t=e.get_handlerId(),i=this._customViewLoadCallbacks[t];if(!a.isNullOrUndefined(i)){var n=i;for(var r in n){var o={key:r,value:n[r]},s=o.value;a.isValue(s.get_successCallback())&&s.get_successCallback()(null)}delete this._customViewLoadCallbacks[t]}},_handleStateReadyForQuery:function(e){var t=this._commandReturnAfterStateReadyQueues[e.get_handlerId()];if(!l._Utility.isNullOrEmpty(t))for(;t.length>0;){var i=t.pop();a.isValue(i)&&i()}},_getHandleCrossDomainMessageDelegate:function(){return a.Delegate.create(this,function(e){this._handleCrossDomainMessage(e)})},_handleCrossDomainMessage:function(e){if(!a.isNullOrUndefined(e.data)){var t=l._ApiCommand.parse(e.data),i=t.get_rawName(),n=t.get_handlerId(),r=this._handlers[n];(a.isNullOrUndefined(r)||r.get_handlerId()!==t.get_handlerId())&&(r=new l._doNothingCrossDomainHandler),t.get_isApiCommandName()?"xdomainSourceId"===t.get_sourceId()?(r.handleEventNotification(t.get_name(),t.get_parameters()),"api.FirstVizSizeKnownEvent"===t.get_name()&&e.source.postMessage("tableau.bootstrap","*")):this._handleCrossDomainResponse(t):this._handleLegacyNotifications(i,e,r)}},_handleCrossDomainResponse:function(e){var t=this._commandCallbacks[e.get_handlerId()],i=a.isValue(t)?t[e.get_sourceId()]:null;if(!a.isNullOrUndefined(i)&&(delete t[e.get_sourceId()],e.get_name()===i.get_commandName())){var n=new l._ApiServerResultParser(e.get_parameters()),r=n.get_data();if("api.success"===n.get_result())switch(i.get_successCallbackTiming()){case 0:a.isValue(i.get_successCallback())&&i.get_successCallback()(r);break;case 1:var o=function(){a.isValue(i.get_successCallback())&&i.get_successCallback()(r)},s=this._commandReturnAfterStateReadyQueues[e.get_handlerId()];a.isNullOrUndefined(s)&&(s=[],this._commandReturnAfterStateReadyQueues[e.get_handlerId()]=s),s.push(o);break;default:throw l._TableauException.createInternalError("Unknown timing value: "+i.get_successCallbackTiming())}else if(a.isValue(i.get_errorCallback())){var u="api.remotefailed"===n.get_result();i.get_errorCallback()(u,r)}}},_handleLegacyNotifications:function(e,t,i){"layoutInfoReq"===e?(l._VizManagerImpl._sendVizOffsets(),this._postLayoutInfo(t.source)):"tableau.completed"!==e&&"completed"!==e||i.handleVizLoad()},_postLayoutInfo:function(e){if(l._Utility.hasWindowPostMessage()){var t=new l.WindowHelper(window.self),i=a.isValue(t.get_innerWidth())?t.get_innerWidth():document.documentElement.offsetWidth,n=a.isValue(t.get_innerHeight())?t.get_innerHeight():document.documentElement.offsetHeight,r=a.isValue(t.get_pageXOffset())?t.get_pageXOffset():document.documentElement.scrollLeft,o=a.isValue(t.get_pageYOffset())?t.get_pageYOffset():document.documentElement.scrollTop,s=[];s.push("layoutInfoResp"),s.push(r),s.push(o),s.push(i),s.push(n),e.postMessage(s.join(","),"*")}}},l._doNothingCrossDomainHandler=function(){},l._doNothingCrossDomainHandler.prototype={_handlerId:null,add_customViewsListLoad:function(e){this.__customViewsListLoad=a.Delegate.combine(this.__customViewsListLoad,e)},remove_customViewsListLoad:function(e){this.__customViewsListLoad=a.Delegate.remove(this.__customViewsListLoad,e)},__customViewsListLoad:null,add_stateReadyForQuery:function(e){this.__stateReadyForQuery=a.Delegate.combine(this.__stateReadyForQuery,e)},remove_stateReadyForQuery:function(e){this.__stateReadyForQuery=a.Delegate.remove(this.__stateReadyForQuery,e)},__stateReadyForQuery:null,get_iframe:function(){return null},get_handlerId:function(){return this._handlerId},set_handlerId:function(e){return this._handlerId=e,e},get_serverRoot:function(){return"*"},handleVizLoad:function(){},handleEventNotification:function(e,t){},_silenceTheCompilerWarning:function(){this.__customViewsListLoad(null),this.__stateReadyForQuery(null)}},l.CrossDomainMessagingOptions=function(e,t){l._Param.verifyValue(e,"router"),l._Param.verifyValue(t,"handler"),this._router=e,this._handler=t},l.CrossDomainMessagingOptions.prototype={_router:null,_handler:null,get_router:function(){return this._router},get_handler:function(){return this._handler},sendCommand:function(e,t){this._router.sendCommand(this._handler,e,t)}},l._enums=function(){},l._enums._normalizePeriodType=function(e,t){var i=a.isValue(e)?e:"";return l._enums._normalizeEnum(i,t,r.PeriodType,!0)},l._enums._normalizeDateRangeType=function(e,t){var i=a.isValue(e)?e:"";return l._enums._normalizeEnum(i,t,r.DateRangeType,!0)},l._enums._normalizeFilterUpdateType=function(e,t){var i=a.isValue(e)?e:"";return l._enums._normalizeEnum(i,t,r.FilterUpdateType,!0)},l._enums._normalizeSelectionUpdateType=function(e,t){var i=a.isValue(e)?e:"";return l._enums._normalizeEnum(i,t,r.SelectionUpdateType,!0)},l._enums._isSelectionUpdateType=function(e){var t=a.isValue(e)?e.toString():"";return null!=l._enums._normalizeEnum(t,"",r.SelectionUpdateType,!1)},l._enums._normalizeNullOption=function(e,t){var i=a.isValue(e)?e:"";return l._enums._normalizeEnum(i,t,r.NullOption,!0)},l._enums._normalizeSheetSizeBehavior=function(e,t){var i=a.isValue(e)?e:"";return l._enums._normalizeEnum(i,t,r.SheetSizeBehavior,!0)},l._enums._normalizeTableauEventName=function(e){var t=a.isValue(e)?e:"";return l._enums._normalizeEnum(t,"",r.TableauEventName,!1)},l._enums._normalizeEnum=function(e,t,i,n){if(a.isValue(e)){var r=e.toString().toUpperCase(),o=i;for(var s in o){var u={key:s,value:o[s]};if(r===u.value.toString().toUpperCase())return u.value}}if(n)throw l._TableauException.createInvalidParameter(t);return null},l._ApiBootstrap=function(){},l._ApiBootstrap.initialize=function(){l._ApiObjectRegistry.registerCrossDomainMessageRouter(function(){return new l._crossDomainMessageRouter})},l._ApiObjectRegistry=function(){},l._ApiObjectRegistry.registerCrossDomainMessageRouter=function(e){return l._ApiObjectRegistry._registerType("ICrossDomainMessageRouter",e)},l._ApiObjectRegistry.getCrossDomainMessageRouter=function(){return l._ApiObjectRegistry._getSingleton("ICrossDomainMessageRouter")},l._ApiObjectRegistry.disposeCrossDomainMessageRouter=function(){l._ApiObjectRegistry._clearSingletonInstance("ICrossDomainMessageRouter")},l._ApiObjectRegistry._registerType=function(e,t){a.isNullOrUndefined(l._ApiObjectRegistry._creationRegistry)&&(l._ApiObjectRegistry._creationRegistry={});var i=l._ApiObjectRegistry._creationRegistry[e];return l._ApiObjectRegistry._creationRegistry[e]=t,i},l._ApiObjectRegistry._createType=function(e){if(a.isNullOrUndefined(l._ApiObjectRegistry._creationRegistry))throw l._TableauException.createInternalError("No types registered");var t=l._ApiObjectRegistry._creationRegistry[e];if(a.isNullOrUndefined(t))throw l._TableauException.createInternalError("No creation function has been registered for interface type '"+e+"'.");return t()},l._ApiObjectRegistry._getSingleton=function(e){a.isNullOrUndefined(l._ApiObjectRegistry._singletonInstanceRegistry)&&(l._ApiObjectRegistry._singletonInstanceRegistry={});var t=l._ApiObjectRegistry._singletonInstanceRegistry[e];return a.isNullOrUndefined(t)&&(t=l._ApiObjectRegistry._createType(e),l._ApiObjectRegistry._singletonInstanceRegistry[e]=t),t},l._ApiObjectRegistry._clearSingletonInstance=function(e){if(a.isNullOrUndefined(l._ApiObjectRegistry._singletonInstanceRegistry))return null;var t=l._ApiObjectRegistry._singletonInstanceRegistry[e];return delete l._ApiObjectRegistry._singletonInstanceRegistry[e],t},l._CustomViewImpl=function(e,t,i){this._workbookImpl=e,this._name=t,this._messagingOptions=i,this._isPublic=!1,this._isDefault=!1,this._isStale=!1},l._CustomViewImpl._getAsync=function(e){var t=new l._Deferred;return t.resolve(e.get__customViewImpl().get__customView()),t.get_promise()},l._CustomViewImpl._createNew=function(e,t,i,n){var r=new l._CustomViewImpl(e,i.name,t);return r._isPublic=i.isPublic,r._url=i.url,r._ownerName=i.owner.friendlyName,r._isDefault=a.isValue(n)&&n===i.id,r._presModel=i,r},l._CustomViewImpl._saveNewAsync=function(e,t,i){var n=new l._Deferred,r={};r["api.customViewName"]=i;var o=l._CustomViewImpl._createCustomViewCommandReturnHandler("api.SaveNewCustomViewCommand",n,function(i){l._CustomViewImpl._processCustomViewUpdate(e,t,i,!0);var r=null;a.isValue(e.get__updatedCustomViews())&&(r=e.get__updatedCustomViews().get_item(0)),n.resolve(r)});return t.sendCommand(r,o),n.get_promise()},l._CustomViewImpl._showCustomViewAsync=function(e,t,i){var n=new l._Deferred,r={};a.isValue(i)&&(r["api.customViewParam"]=i);var o=l._CustomViewImpl._createCustomViewCommandReturnHandler("api.ShowCustomViewCommand",n,function(t){var i=e.get_activeCustomView();n.resolve(i)});return t.sendCommand(r,o),n.get_promise()},l._CustomViewImpl._makeCurrentCustomViewDefaultAsync=function(e,t){var i=new l._Deferred,n={},r=l._CustomViewImpl._createCustomViewCommandReturnHandler("api.MakeCurrentCustomViewDefaultCommand",i,function(t){var n=e.get_activeCustomView();i.resolve(n)});return t.sendCommand(n,r),i.get_promise()},l._CustomViewImpl._getCustomViewsAsync=function(e,t){var i=new l._Deferred,n=new l._CommandReturnHandler("api.FetchCustomViewsCommand",0,function(n){l._CustomViewImpl._processCustomViews(e,t,n),i.resolve(e.get__customViews()._toApiCollection())},function(e,t){i.reject(l._TableauException.create("serverError",t))});return t.sendCommand(null,n),i.get_promise()},l._CustomViewImpl._processCustomViews=function(e,t,i){l._CustomViewImpl._processCustomViewUpdate(e,t,i,!1)},l._CustomViewImpl._processCustomViewUpdate=function(e,t,i,n){n&&e.set__updatedCustomViews(new l._Collection),e.set__currentCustomView(null);var r=null;a.isValue(i.currentView)&&(r=i.currentView.name);var o=i.defaultCustomViewId;if(n&&a.isValue(i.newView)){var s=l._CustomViewImpl._createNew(e,t,i.newView,o);e.get__updatedCustomViews()._add(s.get__name(),s.get__customView())}if(e.set__removedCustomViews(e.get__customViews()),e.set__customViews(new l._Collection),a.isValue(i.customViews)){var u=i.customViews;if(u.length>0)for(var _=0;_<u.length;_++){var c=l._CustomViewImpl._createNew(e,t,u[_],o);e.get__customViews()._add(c.get__name(),c.get__customView()),e.get__removedCustomViews()._has(c.get__name())?e.get__removedCustomViews()._remove(c.get__name()):n&&(e.get__updatedCustomViews()._has(c.get__name())||e.get__updatedCustomViews()._add(c.get__name(),c.get__customView())),a.isValue(r)&&c.get__name()===r&&e.set__currentCustomView(c.get__customView())}}},l._CustomViewImpl._createCustomViewCommandReturnHandler=function(e,t,i){var n=function(e,i){t.reject(l._TableauException.create("serverError",i))};return new l._CommandReturnHandler(e,0,i,n)},l._CustomViewImpl.prototype={_customView:null,_presModel:null,_workbookImpl:null,_messagingOptions:null,_name:null,_ownerName:null,_url:null,_isPublic:!1,_isDefault:!1,_isStale:!1,get__customView:function(){return null==this._customView&&(this._customView=new r.CustomView(this)),this._customView},get__workbook:function(){return this._workbookImpl.get_workbook()},get__url:function(){return this._url},get__name:function(){return this._name},set__name:function(e){if(this._isStale)throw l._TableauException.create("staleDataReference","Stale data");return this._name=e,e},get__ownerName:function(){return this._ownerName},get__advertised:function(){return this._isPublic},set__advertised:function(e){if(this._isStale)throw l._TableauException.create("staleDataReference","Stale data");return this._isPublic=e,e},get__isDefault:function(){return this._isDefault},saveAsync:function(){if(this._isStale||a.isNullOrUndefined(this._presModel))throw l._TableauException.create("staleDataReference","Stale data");this._presModel.isPublic=this._isPublic,this._presModel.name=this._name;var e=new l._Deferred,t={};t["api.customViewParam"]=this._presModel;var i=l._CustomViewImpl._createCustomViewCommandReturnHandler("api.UpdateCustomViewCommand",e,a.Delegate.create(this,function(t){l._CustomViewImpl._processCustomViewUpdate(this._workbookImpl,this._messagingOptions,t,!0),e.resolve(this.get__customView())}));return this._messagingOptions.sendCommand(t,i),e.get_promise()},_removeAsync:function(){var e=new l._Deferred,t={};t["api.customViewParam"]=this._presModel;var i=l._CustomViewImpl._createCustomViewCommandReturnHandler("api.RemoveCustomViewCommand",e,a.Delegate.create(this,function(t){this._isStale=!0,l._CustomViewImpl._processCustomViews(this._workbookImpl,this._messagingOptions,t),e.resolve(this.get__customView())}));return this._messagingOptions.sendCommand(t,i),e.get_promise()},_showAsync:function(){if(this._isStale||a.isNullOrUndefined(this._presModel))throw l._TableauException.create("staleDataReference","Stale data");return l._CustomViewImpl._showCustomViewAsync(this._workbookImpl,this._messagingOptions,this._presModel)},_isDifferent:function(e){return this._ownerName!==e._ownerName||this._url!==e._url||this._isPublic!==e._isPublic||this._isDefault!==e._isDefault}},l._DashboardImpl=function(e,t,i){this._worksheets$1=new l._Collection,this._dashboardObjects$1=new l._Collection,l._DashboardImpl.initializeBase(this,[e,t,i])},l._DashboardImpl.prototype={_dashboard$1:null,get_sheet:function(){return this.get_dashboard()},get_dashboard:function(){return null==this._dashboard$1&&(this._dashboard$1=new r.Dashboard(this)),this._dashboard$1},get_worksheets:function(){return this._worksheets$1},get_objects:function(){return this._dashboardObjects$1},_addObjects:function(e,t){this._dashboardObjects$1=new l._Collection,this._worksheets$1=new l._Collection;for(var i=0;i<e.length;i++){var n=e[i],o=null;if("worksheet"===e[i]._objectType){var s=n._name;if(a.isNullOrUndefined(s))continue;var u=this._worksheets$1.get__length(),_=l.SheetSizeFactory.createAutomatic(),c=t(s),m=a.isNullOrUndefined(c),h=m?"":c.getUrl(),p=l.$create__SheetInfoImpl(s,"worksheet",u,_,this.get_workbook(),h,!1,m,n._zoneId),d=new l._WorksheetImpl(p,this.get_workbookImpl(),this.get_messagingOptions(),this);o=d.get_worksheet(),this._worksheets$1._add(s,d.get_worksheet())}var f=new r.DashboardObject(n,this.get_dashboard(),o);this._dashboardObjects$1._add(i.toString(),f)}}},l._DataSourceImpl=function(e,t){this._fields=new l._Collection,l._Param.verifyString(e,"name"),this._name=e,this._isPrimary=t},l._DataSourceImpl.processDataSource=function(e){for(var t=new l._DataSourceImpl(e.name,e.isPrimary),i=e.fields||new Array(0),n=a.IEnumerator.getEnumerator(i);n.moveNext();){var o=n.current,s=new r.Field(t.get_dataSource(),o.name,o.role,o.aggregation);t.addField(s)}return t},l._DataSourceImpl.processDataSourcesForWorksheet=function(e){for(var t=new l._Collection,i=null,n=a.IEnumerator.getEnumerator(e.dataSources);n.moveNext();){var r=n.current,o=l._DataSourceImpl.processDataSource(r);r.isPrimary?i=o:t._add(r.name,o.get_dataSource())}return a.isValue(i)&&t._addToFirst(i.get_name(),i.get_dataSource()),t},l._DataSourceImpl.prototype={_name:null,_isPrimary:!1,_dataSource:null,get_dataSource:function(){return null==this._dataSource&&(this._dataSource=new r.DataSource(this)),this._dataSource},get_name:function(){return this._name},get_fields:function(){return this._fields},get_isPrimary:function(){return this._isPrimary},addField:function(e){this._fields._add(e.getName(),e)}},l._deferredUtil=function(){},l._deferredUtil.coerceToTrustedPromise=function(e){var t;if(e instanceof r.Promise)t=e;else if(a.isValue(e)&&"function"==typeof e.valueOf&&(e=e.valueOf()),l._deferredUtil.isPromise(e)){var i=new l._DeferredImpl;e.then(a.Delegate.create(i,i.resolve),a.Delegate.create(i,i.reject)),t=i.get_promise()}else t=l._deferredUtil.resolved(e);return t},l._deferredUtil.reject=function(e){return l._deferredUtil.coerceToTrustedPromise(e).then(function(e){return l._deferredUtil.rejected(e)},null)},l._deferredUtil.resolved=function(e){return new l._PromiseImpl(function(t,i){try{return l._deferredUtil.coerceToTrustedPromise(a.isValue(t)?t(e):e)}catch(e){return l._deferredUtil.rejected(e)}})},l._deferredUtil.rejected=function(e){return new l._PromiseImpl(function(t,i){try{return a.isValue(i)?l._deferredUtil.coerceToTrustedPromise(i(e)):l._deferredUtil.rejected(e)}catch(e){return l._deferredUtil.rejected(e)}})},l._deferredUtil.isPromise=function(e){return a.isValue(e)&&"function"==typeof e.then},l._CollectionImpl=function(){this._items=[],this._itemMap={}},l._CollectionImpl.prototype={get__length:function(){return this._items.length},get__rawArray:function(){return this._items},_get:function(e){var t=this._ensureValidKey(e);if(a.isValue(this._itemMap[t]))return this._itemMap[t]},_has:function(e){return a.isValue(this._get(e))},_add:function(e,t){this._verifyKeyAndItemParameters(e,t);var i=this._ensureValidKey(e);this._items.push(t),this._itemMap[i]=t},_addToFirst:function(e,t){this._verifyKeyAndItemParameters(e,t);var i=this._ensureValidKey(e);this._items.unshift(t),this._itemMap[i]=t},_remove:function(e){var t=this._ensureValidKey(e);if(a.isValue(this._itemMap[t])){var i=this._itemMap[t];delete this._itemMap[t];for(var n=0;n<this._items.length;n++)if(this._items[n]===i){this._items.splice(n,1);break}}},_toApiCollection:function(){var e=this._items.concat();return e.get=a.Delegate.create(this,function(e){return this._get(e)}),e.has=a.Delegate.create(this,function(e){return this._has(e)}),e},_verifyUniqueKeyParameter:function(e){if(l._Utility.isNullOrEmpty(e))throw new Error("Null key");if(this._has(e))throw new Error("Duplicate key '"+e+"'")},_verifyKeyAndItemParameters:function(e,t){if(this._verifyUniqueKeyParameter(e),a.isNullOrUndefined(t))throw new Error("Null item")},_ensureValidKey:function(e){return"_"+e},get_item:function(e){return this._items[e]}},l._DeferredImpl=function(){this._listeners=[],this._promise=new l._PromiseImpl(a.Delegate.create(this,this.then)),this._thenFunc=a.Delegate.create(this,this._preResolutionThen),this._resolveFunc=a.Delegate.create(this,this._transitionToFulfilled)},l._DeferredImpl.prototype={_promise:null,_thenFunc:null,_resolveFunc:null,get_promise:function(){return this._promise},all:function(e){var t=new l._DeferredImpl,i=e.length,n=i,r=[];if(!i)return t.resolve(r),t.get_promise();for(var a=0;a<i;a++)!function(e,i){l._deferredUtil.coerceToTrustedPromise(e).then(function(e){return r[i]=e,n--,n||t.resolve(r),null},function(e){return t.reject(e),null})}(e[a],a);return t.get_promise()},then:function(e,t){return this._thenFunc(e,t)},resolve:function(e){return this._resolveFunc(e)},reject:function(e){return this._resolveFunc(l._deferredUtil.rejected(e))},_preResolutionThen:function(e,t){var i=new l._DeferredImpl;return this._listeners.push(function(n){n.then(e,t).then(a.Delegate.create(i,i.resolve),a.Delegate.create(i,i.reject))}),i.get_promise()},_transitionToFulfilled:function(e){var t=l._deferredUtil.coerceToTrustedPromise(e);this._thenFunc=t.then,this._resolveFunc=l._deferredUtil.coerceToTrustedPromise;for(var i=0;i<this._listeners.length;i++){(0,this._listeners[i])(t)}return this._listeners=null,t}},l._PromiseImpl=function(e){this.then=e},l._PromiseImpl.prototype={then:null,always:function(e){return this.then(e,e)},otherwise:function(e){return this.then(null,e)}},l._markImpl=function(e){if(this._collection=new l._Collection,l._jQueryShim.isArray(e))for(var t=e,i=0;i<t.length;i++){var n=t[i];if(!a.isValue(n.fieldName))throw l._TableauException.createInvalidParameter("pair.fieldName");if(!a.isValue(n.value))throw l._TableauException.createInvalidParameter("pair.value");var o=new r.Pair(n.fieldName,n.value);this._collection._add(o.fieldName,o)}else this._tupleId=e},l._markImpl._processSelectedMarks=function(e){var t=new l._Collection;if(a.isNullOrUndefined(e)||l._Utility.isNullOrEmpty(e.marks))return t;for(var i=a.IEnumerator.getEnumerator(e.marks);i.moveNext();){var n=i.current,o=n.tupleId,s=new r.Mark(o);t._add(o.toString(),s);for(var u=a.IEnumerator.getEnumerator(n.pairs);u.moveNext();){var _=u.current,c=l._Utility.convertRawValue(_.value,_.valueDataType),m=new r.Pair(_.fieldName,c);m.formattedValue=_.formattedValue,s._impl.get__pairs()._has(m.fieldName)||s._impl._addPair(m)}}return t},l._markImpl.prototype={_clonedPairs:null,_tupleId:0,get__pairs:function(){return this._collection},get__tupleId:function(){return this._tupleId},get__clonedPairs:function(){return null==this._clonedPairs&&(this._clonedPairs=this._collection._toApiCollection()),this._clonedPairs},_addPair:function(e){this._collection._add(e.fieldName,e)}},l._Param=function(){},l._Param.verifyString=function(e,t){if(a.isNullOrUndefined(e)||!e.length)throw l._TableauException.createInternalStringArgumentException(t)},l._Param.verifyValue=function(e,t){if(a.isNullOrUndefined(e))throw l._TableauException.createInternalNullArgumentException(t)},l._parameterImpl=function(e){if(this._name=e.name,this._currentValue=l._Utility.getDataValue(e.currentValue),this._dataType=e.dataType,this._allowableValuesType=e.allowableValuesType,a.isValue(e.allowableValues)&&"list"===this._allowableValuesType){this._allowableValues=[];for(var t=a.IEnumerator.getEnumerator(e.allowableValues);t.moveNext();){var i=t.current;this._allowableValues.push(l._Utility.getDataValue(i))}}"range"===this._allowableValuesType&&(this._minValue=l._Utility.getDataValue(e.minValue),this._maxValue=l._Utility.getDataValue(e.maxValue),this._stepSize=e.stepSize,("date"===this._dataType||"datetime"===this._dataType)&&a.isValue(this._stepSize)&&a.isValue(e.dateStepPeriod)&&(this._dateStepPeriod=e.dateStepPeriod))},l._parameterImpl.prototype={_parameter:null,_name:null,_currentValue:null,_dataType:null,_allowableValuesType:null,_allowableValues:null,_minValue:null,_maxValue:null,_stepSize:null,_dateStepPeriod:null,get__parameter:function(){return null==this._parameter&&(this._parameter=new r.Parameter(this)),this._parameter},get__name:function(){return this._name},get__currentValue:function(){return this._currentValue},get__dataType:function(){return this._dataType},get__allowableValuesType:function(){return this._allowableValuesType},get__allowableValues:function(){return this._allowableValues},get__minValue:function(){return this._minValue},get__maxValue:function(){return this._maxValue},get__stepSize:function(){return this._stepSize},get__dateStepPeriod:function(){return this._dateStepPeriod}},l._SheetImpl=function(e,t,i){l._Param.verifyValue(e,"sheetInfoImpl"),l._Param.verifyValue(t,"workbookImpl"),l._Param.verifyValue(i,"messagingOptions"),this._name=e.name,this._index=e.index,this._isActive=e.isActive,this._isHidden=e.isHidden,this._sheetType=e.sheetType,this._size=e.size,this._url=e.url,this._workbookImpl=t,this._messagingOptions=i,this._zoneId=e.zoneId},l._SheetImpl._convertValueToIntIfValid=function(e){return a.isValue(e)?l._Utility.toInt(e):e},l._SheetImpl._normalizeSheetSize=function(e){var t=l._enums._normalizeSheetSizeBehavior(e.behavior,"size.behavior"),i=e.minSize;a.isValue(i)&&(i=l.$create_Size(l._SheetImpl._convertValueToIntIfValid(e.minSize.width),l._SheetImpl._convertValueToIntIfValid(e.minSize.height)));var n=e.maxSize;return a.isValue(n)&&(n=l.$create_Size(l._SheetImpl._convertValueToIntIfValid(e.maxSize.width),l._SheetImpl._convertValueToIntIfValid(e.maxSize.height))),l.$create_SheetSize(t,i,n)},l._SheetImpl.prototype={_name:null,_index:0,_isActive:!1,_isHidden:!1,_sheetType:null,_size:null,_url:null,_workbookImpl:null,_messagingOptions:null,_parentStoryPointImpl:null,_zoneId:0,get_name:function(){return this._name},get_index:function(){return this._index},get_workbookImpl:function(){return this._workbookImpl},get_workbook:function(){return this._workbookImpl.get_workbook()},get_url:function(){if(this._isHidden)throw l._TableauException.createNoUrlForHiddenWorksheet();return this._url},get_size:function(){return this._size},get_isHidden:function(){return this._isHidden},get_isActive:function(){return this._isActive},set_isActive:function(e){return this._isActive=e,e},get_isDashboard:function(){return"dashboard"===this._sheetType},get_sheetType:function(){return this._sheetType},get_parentStoryPoint:function(){return a.isValue(this._parentStoryPointImpl)?this._parentStoryPointImpl.get_storyPoint():null},get_parentStoryPointImpl:function(){return this._parentStoryPointImpl},set_parentStoryPointImpl:function(e){if("story"===this._sheetType)throw l._TableauException.createInternalError("A story cannot be a child of another story.");return this._parentStoryPointImpl=e,e},get_zoneId:function(){return this._zoneId},get_messagingOptions:function(){return this._messagingOptions},changeSizeAsync:function(e){if(e=l._SheetImpl._normalizeSheetSize(e),"worksheet"===this._sheetType&&"automatic"!==e.behavior)throw l._TableauException.createInvalidSizeBehaviorOnWorksheet();var t=new l._Deferred;if(this._size.behavior===e.behavior&&"automatic"===e.behavior)return t.resolve(e),t.get_promise();var i=this._processSheetSize(e),n={};n["api.setSheetSizeName"]=this._name,n["api.minWidth"]=i["api.minWidth"],n["api.minHeight"]=i["api.minHeight"],n["api.maxWidth"]=i["api.maxWidth"],n["api.maxHeight"]=i["api.maxHeight"];var r=new l._CommandReturnHandler("api.SetSheetSizeCommand",1,a.Delegate.create(this,function(e){this.get_workbookImpl()._update(a.Delegate.create(this,function(){var e=this.get_workbookImpl().get_publishedSheets()._get(this.get_name()).getSize();t.resolve(e)}))}),function(e,i){t.reject(l._TableauException.createServerError(i))});return this.sendCommand(n,r),t.get_promise()},sendCommand:function(e,t){this._messagingOptions.sendCommand(e,t)},_processSheetSize:function(e){var t=null;if(a.isNullOrUndefined(e)||a.isNullOrUndefined(e.behavior)||"automatic"!==e.behavior&&a.isNullOrUndefined(e.minSize)&&a.isNullOrUndefined(e.maxSize))throw l._TableauException.createInvalidSheetSizeParam();var i=0,n=0,r=0,o=0,s={};if(s["api.minWidth"]=0,s["api.minHeight"]=0,s["api.maxWidth"]=0,s["api.maxHeight"]=0,"automatic"===e.behavior)t=l.$create_SheetSize("automatic",void 0,void 0);else if("atmost"===e.behavior){if(a.isNullOrUndefined(e.maxSize)||a.isNullOrUndefined(e.maxSize.width)||a.isNullOrUndefined(e.maxSize.height))throw l._TableauException.createMissingMaxSize();if(e.maxSize.width<0||e.maxSize.height<0)throw l._TableauException.createInvalidSizeValue();s["api.maxWidth"]=e.maxSize.width,s["api.maxHeight"]=e.maxSize.height,t=l.$create_SheetSize("atmost",void 0,e.maxSize)}else if("atleast"===e.behavior){if(a.isNullOrUndefined(e.minSize)||a.isNullOrUndefined(e.minSize.width)||a.isNullOrUndefined(e.minSize.height))throw l._TableauException.createMissingMinSize();if(e.minSize.width<0||e.minSize.height<0)throw l._TableauException.createInvalidSizeValue();s["api.minWidth"]=e.minSize.width,s["api.minHeight"]=e.minSize.height,t=l.$create_SheetSize("atleast",e.minSize,void 0)}else if("range"===e.behavior){if(a.isNullOrUndefined(e.minSize)||a.isNullOrUndefined(e.maxSize)||a.isNullOrUndefined(e.minSize.width)||a.isNullOrUndefined(e.maxSize.width)||a.isNullOrUndefined(e.minSize.height)||a.isNullOrUndefined(e.maxSize.height))throw l._TableauException.createMissingMinMaxSize();if(e.minSize.width<0||e.minSize.height<0||e.maxSize.width<0||e.maxSize.height<0||e.minSize.width>e.maxSize.width||e.minSize.height>e.maxSize.height)throw l._TableauException.createInvalidRangeSize();s["api.minWidth"]=e.minSize.width,s["api.minHeight"]=e.minSize.height,s["api.maxWidth"]=e.maxSize.width,s["api.maxHeight"]=e.maxSize.height,t=l.$create_SheetSize("range",e.minSize,e.maxSize)}else if("exactly"===e.behavior){if(a.isValue(e.minSize)&&a.isValue(e.maxSize)&&a.isValue(e.minSize.width)&&a.isValue(e.maxSize.width)&&a.isValue(e.minSize.height)&&a.isValue(e.maxSize.height)){if(i=e.minSize.width,n=e.minSize.height,r=e.maxSize.width,o=e.maxSize.height,i!==r||n!==o)throw l._TableauException.createSizeConflictForExactly()}else a.isValue(e.minSize)&&a.isValue(e.minSize.width)&&a.isValue(e.minSize.height)?(i=e.minSize.width,n=e.minSize.height,r=i,o=n):a.isValue(e.maxSize)&&a.isValue(e.maxSize.width)&&a.isValue(e.maxSize.height)&&(r=e.maxSize.width,o=e.maxSize.height,i=r,n=o);s["api.minWidth"]=i,s["api.minHeight"]=n,s["api.maxWidth"]=r,s["api.maxHeight"]=o,t=l.$create_SheetSize("exactly",l.$create_Size(i,n),l.$create_Size(r,o))}return this._size=t,s}},l._StoryImpl=function(e,t,i,n,r){l._StoryImpl.initializeBase(this,[e,t,i]),l._Param.verifyValue(n,"storyPm"),l._Param.verifyValue(r,"findSheetFunc"),this._findSheetFunc$1=r,this.update(n)},l._StoryImpl.prototype={_activeStoryPointImpl$1:null,_findSheetFunc$1:null,_story$1:null,_storyPointsInfo$1:null,add_activeStoryPointChange:function(e){this.__activeStoryPointChange$1=a.Delegate.combine(this.__activeStoryPointChange$1,e)},remove_activeStoryPointChange:function(e){this.__activeStoryPointChange$1=a.Delegate.remove(this.__activeStoryPointChange$1,e)},__activeStoryPointChange$1:null,get_activeStoryPointImpl:function(){return this._activeStoryPointImpl$1},get_sheet:function(){return this.get_story()},get_story:function(){return null==this._story$1&&(this._story$1=new r.Story(this)),this._story$1},get_storyPointsInfo:function(){return this._storyPointsInfo$1},update:function(e){var t=null,i=null;this._storyPointsInfo$1=this._storyPointsInfo$1||new Array(e.storyPoints.length);for(var n=0;n<e.storyPoints.length;n++){var o=e.storyPoints[n],s=o.caption,u=n===e.activeStoryPointIndex,_=l.$create__StoryPointInfoImpl(s,n,o.storyPointId,u,o.isUpdated,this);if(a.isNullOrUndefined(this._storyPointsInfo$1[n]))this._storyPointsInfo$1[n]=new r.StoryPointInfo(_);else if(this._storyPointsInfo$1[n]._impl.storyPointId===_.storyPointId){var c=this._storyPointsInfo$1[n]._impl;c.caption=_.caption,c.index=_.index,c.isActive=u,c.isUpdated=_.isUpdated}else this._storyPointsInfo$1[n]=new r.StoryPointInfo(_);u&&(t=o.containedSheetInfo,i=_)}var m=this._storyPointsInfo$1.length-e.storyPoints.length;this._storyPointsInfo$1.splice(e.storyPoints.length,m);var h=a.isNullOrUndefined(this._activeStoryPointImpl$1)||this._activeStoryPointImpl$1.get_storyPointId()!==i.storyPointId;a.isValue(this._activeStoryPointImpl$1)&&h&&this._activeStoryPointImpl$1.set_isActive(!1);var p=this._activeStoryPointImpl$1;if(h){var d=l._StoryPointImpl.createContainedSheet(t,this.get_workbookImpl(),this.get_messagingOptions(),this._findSheetFunc$1);this._activeStoryPointImpl$1=new l._StoryPointImpl(i,d)}else this._activeStoryPointImpl$1.set_isActive(i.isActive),this._activeStoryPointImpl$1.set_isUpdated(i.isUpdated);h&&a.isValue(p)&&this._raiseActiveStoryPointChange$1(this._storyPointsInfo$1[p.get_index()],this._activeStoryPointImpl$1.get_storyPoint())},activatePreviousStoryPointAsync:function(){return this._activatePreviousNextStoryPointAsync$1("api.ActivatePreviousStoryPoint")},activateNextStoryPointAsync:function(){return this._activatePreviousNextStoryPointAsync$1("api.ActivateNextStoryPoint")},activateStoryPointAsync:function(e){var t=new l._Deferred;if(e<0||e>=this._storyPointsInfo$1.length)throw l._TableauException.createIndexOutOfRange(e);var i=this.get_activeStoryPointImpl(),n={};n["api.storyPointIndex"]=e;var r=new l._CommandReturnHandler("api.ActivateStoryPoint",0,a.Delegate.create(this,function(e){var n=e;this._updateActiveState$1(i,n),t.resolve(this._activeStoryPointImpl$1.get_storyPoint())}),function(e,i){t.reject(l._TableauException.createServerError(i))});return this.sendCommand(n,r),t.get_promise()},revertStoryPointAsync:function(e){if((e=e||this._activeStoryPointImpl$1.get_index())<0||e>=this._storyPointsInfo$1.length)throw l._TableauException.createIndexOutOfRange(e);var t=new l._Deferred,i={};i["api.storyPointIndex"]=e;var n=new l._CommandReturnHandler("api.RevertStoryPoint",0,a.Delegate.create(this,function(i){var n=i;this._updateStoryPointInfo$1(e,n),t.resolve(this._storyPointsInfo$1[e])}),function(e,i){t.reject(l._TableauException.createServerError(i))});return this.sendCommand(i,n),t.get_promise()},_activatePreviousNextStoryPointAsync$1:function(e){if("api.ActivatePreviousStoryPoint"!==e&&"api.ActivateNextStoryPoint"!==e)throw l._TableauException.createInternalError("commandName '"+e+"' is invalid.");var t=new l._Deferred,i=this.get_activeStoryPointImpl(),n={},r=new l._CommandReturnHandler(e,0,a.Delegate.create(this,function(e){var n=e;this._updateActiveState$1(i,n),t.resolve(this._activeStoryPointImpl$1.get_storyPoint())}),function(e,i){t.reject(l._TableauException.createServerError(i))});return this.sendCommand(n,r),t.get_promise()},_updateStoryPointInfo$1:function(e,t){var i=this._storyPointsInfo$1[e]._impl;if(i.storyPointId!==t.storyPointId)throw l._TableauException.createInternalError("We should not be updating a story point where the IDs don't match. Existing storyPointID="+i.storyPointId+", newStoryPointID="+t.storyPointId);i.caption=t.caption,i.isUpdated=t.isUpdated,t.storyPointId===this._activeStoryPointImpl$1.get_storyPointId()&&this._activeStoryPointImpl$1.set_isUpdated(t.isUpdated)},_updateActiveState$1:function(e,t){var i=t.index;if(e.get_index()!==i){var n=this._storyPointsInfo$1[e.get_index()],r=this._storyPointsInfo$1[i]._impl,a=l._StoryPointImpl.createContainedSheet(t.containedSheetInfo,this.get_workbookImpl(),this.get_messagingOptions(),this._findSheetFunc$1);r.isActive=!0,this._activeStoryPointImpl$1=new l._StoryPointImpl(r,a),e.set_isActive(!1),n._impl.isActive=!1,this._raiseActiveStoryPointChange$1(n,this._activeStoryPointImpl$1.get_storyPoint())}},_raiseActiveStoryPointChange$1:function(e,t){null!=this.__activeStoryPointChange$1&&this.__activeStoryPointChange$1(e,t)}},l._StoryPointImpl=function(e,t){if(this._isActive=e.isActive,this._isUpdated=e.isUpdated,this._caption=e.caption,this._index=e.index,this._parentStoryImpl=e.parentStoryImpl,this._storyPointId=e.storyPointId,this._containedSheetImpl=t,a.isValue(t)&&(this._containedSheetImpl.set_parentStoryPointImpl(this),"dashboard"===t.get_sheetType()))for(var i=this._containedSheetImpl,n=0;n<i.get_worksheets().get__length();n++){var r=i.get_worksheets().get_item(n);r._impl.set_parentStoryPointImpl(this)}},l._StoryPointImpl.createContainedSheet=function(e,t,i,n){var r=e.sheetType,o=l.SheetSizeFactory.createAutomatic(),s=n(e.name),u=a.isNullOrUndefined(s),_=u?"":s.getUrl(),c=l.$create__SheetInfoImpl(e.name,r,-1,o,t.get_workbook(),_,!1,u,e.zoneId);if("worksheet"===e.sheetType){return new l._WorksheetImpl(c,t,i,null)}if("dashboard"===e.sheetType){var m=new l._DashboardImpl(c,t,i),h=l._WorkbookImpl._createDashboardZones(e.dashboardZones);return m._addObjects(h,n),m}throw"story"===e.sheetType?l._TableauException.createInternalError("Cannot have a story embedded within another story."):l._TableauException.createInternalError("Unknown sheet type '"+e.sheetType+"'")},l._StoryPointImpl.prototype={_caption:null,_index:0,_isActive:!1,_isUpdated:!1,_containedSheetImpl:null,_parentStoryImpl:null,_storyPoint:null,_storyPointId:0,get_caption:function(){return this._caption},get_containedSheetImpl:function(){return this._containedSheetImpl},get_index:function(){return this._index},get_isActive:function(){return this._isActive},set_isActive:function(e){return this._isActive=e,e},get_isUpdated:function(){return this._isUpdated},set_isUpdated:function(e){return this._isUpdated=e,e},get_parentStoryImpl:function(){return this._parentStoryImpl},get_storyPoint:function(){return null==this._storyPoint&&(this._storyPoint=new r.StoryPoint(this)),this._storyPoint},get_storyPointId:function(){return this._storyPointId},_toInfoImpl:function(){return l.$create__StoryPointInfoImpl(this._caption,this._index,this._storyPointId,this._isActive,this._isUpdated,this._parentStoryImpl)}},l.StoryPointInfoImplUtil=function(){},l.StoryPointInfoImplUtil.clone=function(e){return l.$create__StoryPointInfoImpl(e.caption,e.index,e.storyPointId,e.isActive,e.isUpdated,e.parentStoryImpl)},l._TableauException=function(){},l._TableauException.create=function(e,t){var i=new Error(t);return i.tableauSoftwareErrorCode=e,i},l._TableauException.createInternalError=function(e){return a.isValue(e)?l._TableauException.create("internalError","Internal error. Please contact Tableau support with the following information: "+e):l._TableauException.create("internalError","Internal error. Please contact Tableau support")},l._TableauException.createInternalNullArgumentException=function(e){return l._TableauException.createInternalError("Null/undefined argument '"+e+"'.")},l._TableauException.createInternalStringArgumentException=function(e){return l._TableauException.createInternalError("Invalid string argument '"+e+"'.")},l._TableauException.createServerError=function(e){return l._TableauException.create("serverError",e)},l._TableauException.createNotActiveSheet=function(){return l._TableauException.create("notActiveSheet","Operation not allowed on non-active sheet")},l._TableauException.createInvalidCustomViewName=function(e){return l._TableauException.create("invalidCustomViewName","Invalid custom view name: "+e)},l._TableauException.createInvalidParameter=function(e){return l._TableauException.create("invalidParameter","Invalid parameter: "+e)},l._TableauException.createInvalidFilterFieldNameOrValue=function(e){return l._TableauException.create("invalidFilterFieldNameOrValue","Invalid filter field name or value: "+e)},l._TableauException.createInvalidDateParameter=function(e){return l._TableauException.create("invalidDateParameter","Invalid date parameter: "+e)},l._TableauException.createNullOrEmptyParameter=function(e){return l._TableauException.create("nullOrEmptyParameter","Parameter cannot be null or empty: "+e)},l._TableauException.createMissingMaxSize=function(){return l._TableauException.create("missingMaxSize","Missing maxSize for SheetSizeBehavior.ATMOST")},l._TableauException.createMissingMinSize=function(){return l._TableauException.create("missingMinSize","Missing minSize for SheetSizeBehavior.ATLEAST")},l._TableauException.createMissingMinMaxSize=function(){return l._TableauException.create("missingMinMaxSize","Missing minSize or maxSize for SheetSizeBehavior.RANGE")},l._TableauException.createInvalidRangeSize=function(){return l._TableauException.create("invalidSize","Missing minSize or maxSize for SheetSizeBehavior.RANGE")},l._TableauException.createInvalidSizeValue=function(){return l._TableauException.create("invalidSize","Size value cannot be less than zero")},l._TableauException.createInvalidSheetSizeParam=function(){return l._TableauException.create("invalidSize","Invalid sheet size parameter")},l._TableauException.createSizeConflictForExactly=function(){return l._TableauException.create("invalidSize","Conflicting size values for SheetSizeBehavior.EXACTLY")},l._TableauException.createInvalidSizeBehaviorOnWorksheet=function(){return l._TableauException.create("invalidSizeBehaviorOnWorksheet","Only SheetSizeBehavior.AUTOMATIC is allowed on Worksheets")},l._TableauException.createNoUrlForHiddenWorksheet=function(){return l._TableauException.create("noUrlForHiddenWorksheet","Hidden worksheets do not have a URL.")},l._TableauException._createInvalidAggregationFieldName=function(e){return l._TableauException.create("invalidAggregationFieldName","Invalid aggregation type for field '"+e+"'")},l._TableauException.createIndexOutOfRange=function(e){return l._TableauException.create("indexOutOfRange","Index '"+e+"' is out of range.")},l._TableauException.createUnsupportedEventName=function(e){return l._TableauException.create("unsupportedEventName","Unsupported event '"+e+"'.")},l._TableauException.createBrowserNotCapable=function(){return l._TableauException.create("browserNotCapable","This browser is incapable of supporting the Tableau JavaScript API.")},l._Utility=function(){},l._Utility.hasOwnProperty=function(e,t){return e.hasOwnProperty(t)},l._Utility.isNullOrEmpty=function(e){return a.isNullOrUndefined(e)||(e.length||0)<=0},l._Utility.isString=function(e){return"string"==typeof e},l._Utility.isNumber=function(e){return"number"==typeof e},l._Utility.isDate=function(e){return"object"===(void 0===e?"undefined":n(e))&&e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},l._Utility.isDateValid=function(e){return!isNaN(e.getTime())},l._Utility.indexOf=function(e,t,i){if(a.isValue(Array.prototype.indexOf))return e.indexOf(t,i);i=i||0;var n=e.length;if(n>0)for(var r=i;r<n;r++)if(e[r]===t)return r;return-1},l._Utility.contains=function(e,t,i){return l._Utility.indexOf(e,t,i)>=0},l._Utility.getTopmostWindow=function(){for(var e=window.self;a.isValue(e.parent)&&e.parent!==e;)e=e.parent;return e},l._Utility.toInt=function(e){return l._Utility.isNumber(e)?e:parseInt(e.toString(),10)},l._Utility.hasClass=function(e,t){var i=new RegExp("[\\n\\t\\r]","g");return a.isValue(e)&&(" "+e.className+" ").replace(i," ").indexOf(" "+t+" ")>-1},l._Utility.findParentWithClassName=function(e,t,i){var n=a.isValue(e)?e.parentNode:null;for(i=i||document.body;null!=n;){if(l._Utility.hasClass(n,t))return n;n=n===i?null:n.parentNode}return n},l._Utility.hasJsonParse=function(){return a.isValue(window.JSON)&&a.isValue(window.JSON.parse)},l._Utility.hasWindowPostMessage=function(){return a.isValue(window.postMessage)},l._Utility.isPostMessageSynchronous=function(){if(l._Utility.isIE()){var e=new RegExp("(msie) ([\\w.]+)"),t=e.exec(window.navigator.userAgent.toLowerCase()),i=t[2]||"0";return parseInt(i,10)<=8}return!1},l._Utility.hasDocumentAttachEvent=function(){return a.isValue(document.attachEvent)},l._Utility.hasWindowAddEventListener=function(){return a.isValue(window.addEventListener)},l._Utility.isElementOfTag=function(e,t){return a.isValue(e)&&1===e.nodeType&&e.tagName.toLowerCase()===t.toLowerCase()},l._Utility.elementToString=function(e){var t=new a.StringBuilder;if(t.append(e.tagName.toLowerCase()),l._Utility.isNullOrEmpty(e.id)||t.append("#").append(e.id),!l._Utility.isNullOrEmpty(e.className)){var i=e.className.split(" ");t.append(".").append(i.join("."))}return t.toString()},l._Utility.tableauGCS=function(e){return a.isValue(window.getComputedStyle)?window.getComputedStyle(e):e.currentStyle},l._Utility.isIE=function(){return window.navigator.userAgent.indexOf("MSIE")>-1&&a.isNullOrUndefined(window.opera)},l._Utility.isSafari=function(){var e=window.navigator.userAgent,t=e.indexOf("Chrome")>=0;return e.indexOf("Safari")>=0&&!t},l._Utility.mobileDetect=function(){var e=window.navigator.userAgent;return-1!==e.indexOf("iPad")||(-1!==e.indexOf("Android")||-1!==e.indexOf("AppleWebKit")&&-1!==e.indexOf("Mobile"))};l._Utility.elementOffset=function(e){var t=null;t=e.getBoundingClientRect();var i=t.top,n=t.left,r=new l.WindowHelper(window.self),a=window.document.documentElement,o=n+r.get_pageXOffset()-a.clientLeft,s=i+r.get_pageYOffset()-a.clientTop;return l.$create_Point(o,s)},l._Utility.convertRawValue=function(e,t){if(a.isNullOrUndefined(e))return null;switch(t){case"bool":return e;case"date":return new Date(e);case"number":return null==e?Number.NaN:e;case"string":default:return e}},l._Utility.getDataValue=function(e){return a.isNullOrUndefined(e)?l.$create_DataValue(null,null,null):l.$create_DataValue(l._Utility.convertRawValue(e.value,e.type),e.formattedValue,e.aliasedValue)},l._Utility.serializeDateForServer=function(e){var t="";if(a.isValue(e)&&l._Utility.isDate(e)){t=e.getUTCFullYear()+"-"+(e.getUTCMonth()+1)+"-"+e.getUTCDate()+" "+e.getUTCHours()+":"+e.getUTCMinutes()+":"+e.getUTCSeconds()}return t},l._Utility.computeContentSize=function(e){var t=l._Utility._getComputedStyle(e),i=parseFloat(t.paddingLeft),n=parseFloat(t.paddingTop),r=parseFloat(t.paddingRight),a=parseFloat(t.paddingBottom),o=e.clientWidth-Math.round(i+r),s=e.clientHeight-Math.round(n+a);return l.$create_Size(o,s)},l._Utility._getComputedStyle=function(e){return a.isValue(window.getComputedStyle)?a.isValue(e.ownerDocument.defaultView.opener)?e.ownerDocument.defaultView.getComputedStyle(e,null):window.getComputedStyle(e,null):a.isValue(e.currentStyle)?e.currentStyle:e.style},l.VizImpl=function(e,t,i,n,r){if(!l._Utility.hasWindowPostMessage()||!l._Utility.hasJsonParse())throw l._TableauException.createBrowserNotCapable();this._messagingOptions=new l.CrossDomainMessagingOptions(e,this),this._viz=t,(a.isNullOrUndefined(i)||1!==i.nodeType)&&(i=document.body),this._parameters=new l._VizParameters(i,n,r),a.isValue(r)&&(this._onFirstInteractiveCallback=r.onFirstInteractive,this._onFirstVizSizeKnownCallback=r.onFirstVizSizeKnown)},l.VizImpl.prototype={_workbookTabSwitchHandler:null,_viz:null,_iframe:null,_parameters:null,_initialAvailableSize:null,_instanceId:null,_workbookImpl:null,_onFirstInteractiveCallback:null,_onFirstVizSizeKnownCallback:null,_onFirstInteractiveAlreadyCalled:!1,_areTabsHidden:!1,_isToolbarHidden:!1,_areAutomaticUpdatesPaused:!1,_messagingOptions:null,_vizSize:null,_windowResizeHandler:null,_initializingWorkbookImpl:!1,add_customViewsListLoad:function(e){this.__customViewsListLoad=a.Delegate.combine(this.__customViewsListLoad,e)},remove_customViewsListLoad:function(e){this.__customViewsListLoad=a.Delegate.remove(this.__customViewsListLoad,e)},__customViewsListLoad:null,add_stateReadyForQuery:function(e){this.__stateReadyForQuery=a.Delegate.combine(this.__stateReadyForQuery,e)},remove_stateReadyForQuery:function(e){this.__stateReadyForQuery=a.Delegate.remove(this.__stateReadyForQuery,e)},__stateReadyForQuery:null,add__marksSelection:function(e){this.__marksSelection=a.Delegate.combine(this.__marksSelection,e)},remove__marksSelection:function(e){this.__marksSelection=a.Delegate.remove(this.__marksSelection,e)},__marksSelection:null,add__filterChange:function(e){this.__filterChange=a.Delegate.combine(this.__filterChange,e)},remove__filterChange:function(e){this.__filterChange=a.Delegate.remove(this.__filterChange,e)},__filterChange:null,add__parameterValueChange:function(e){this.__parameterValueChange=a.Delegate.combine(this.__parameterValueChange,e)},remove__parameterValueChange:function(e){this.__parameterValueChange=a.Delegate.remove(this.__parameterValueChange,e)},__parameterValueChange:null,add__customViewLoad:function(e){this.__customViewLoad=a.Delegate.combine(this.__customViewLoad,e)},remove__customViewLoad:function(e){this.__customViewLoad=a.Delegate.remove(this.__customViewLoad,e)},__customViewLoad:null,add__customViewSave:function(e){this.__customViewSave=a.Delegate.combine(this.__customViewSave,e)},remove__customViewSave:function(e){this.__customViewSave=a.Delegate.remove(this.__customViewSave,e)},__customViewSave:null,add__customViewRemove:function(e){this.__customViewRemove=a.Delegate.combine(this.__customViewRemove,e)},remove__customViewRemove:function(e){this.__customViewRemove=a.Delegate.remove(this.__customViewRemove,e)},__customViewRemove:null,add__customViewSetDefault:function(e){this.__customViewSetDefault=a.Delegate.combine(this.__customViewSetDefault,e)},remove__customViewSetDefault:function(e){this.__customViewSetDefault=a.Delegate.remove(this.__customViewSetDefault,e)},__customViewSetDefault:null,add__tabSwitch:function(e){this.__tabSwitch=a.Delegate.combine(this.__tabSwitch,e)},remove__tabSwitch:function(e){this.__tabSwitch=a.Delegate.remove(this.__tabSwitch,e)},__tabSwitch:null,add__storyPointSwitch:function(e){this.__storyPointSwitch=a.Delegate.combine(this.__storyPointSwitch,e)},remove__storyPointSwitch:function(e){this.__storyPointSwitch=a.Delegate.remove(this.__storyPointSwitch,e)},__storyPointSwitch:null,add__vizResize:function(e){this.__vizResize=a.Delegate.combine(this.__vizResize,e)},remove__vizResize:function(e){this.__vizResize=a.Delegate.remove(this.__vizResize,e)},__vizResize:null,get_handlerId:function(){return this._parameters.handlerId},set_handlerId:function(e){return this._parameters.handlerId=e,e},get_iframe:function(){return this._iframe},get_instanceId:function(){return this._instanceId},get_serverRoot:function(){return this._parameters.serverRoot},get__viz:function(){return this._viz},get__areTabsHidden:function(){return this._areTabsHidden},get__isToolbarHidden:function(){return this._isToolbarHidden},get__isHidden:function(){return"none"===this._iframe.style.display},get__parentElement:function(){return this._parameters.parentElement},get__url:function(){return this._parameters.get_baseUrl()},get__workbook:function(){return this._workbookImpl.get_workbook()},get__workbookImpl:function(){return this._workbookImpl},get__areAutomaticUpdatesPaused:function(){return this._areAutomaticUpdatesPaused},get__vizSize:function(){return this._vizSize},getCurrentUrlAsync:function(){var e=new l._Deferred,t=new l._CommandReturnHandler("api.GetCurrentUrlCommand",0,function(t){e.resolve(t)},function(t,i){e.reject(l._TableauException.createInternalError(i))});return this._sendCommand(null,t),e.get_promise()},handleVizLoad:function(){this._sendVizOffset(),a.isNullOrUndefined(this._workbookImpl)?this._workbookImpl=new l._WorkbookImpl(this,this._messagingOptions,a.Delegate.create(this,function(){this._onWorkbookInteractive()})):this._initializingWorkbookImpl||this._workbookImpl._update(a.Delegate.create(this,function(){this._onWorkbookInteractive()}))},_calculateFrameSize:function(e){var t=this._vizSize.chromeHeight,i=this._vizSize.sheetSize,n=0,r=0;if("exactly"===i.behavior)n=i.maxSize.width,r=i.maxSize.height+t;else{var a,o,s,u;switch(i.behavior){case"range":a=i.minSize.width,o=i.maxSize.width,s=i.minSize.height+t,u=i.maxSize.height+t,n=Math.max(a,Math.min(o,e.width)),r=Math.max(s,Math.min(u,e.height));break;case"atleast":a=i.minSize.width,s=i.minSize.height+t,n=Math.max(a,e.width),r=Math.max(s,e.height);break;case"atmost":o=i.maxSize.width,u=i.maxSize.height+t,n=Math.min(o,e.width),r=Math.min(u,e.height);break;case"automatic":n=e.width,r=Math.max(e.height,t);break;default:throw l._TableauException.createInternalError("Unknown SheetSizeBehavior for viz: "+i.behavior)}}return l.$create_Size(n,r)},_getNewFrameSize:function(){var e;return a.isValue(this._initialAvailableSize)?(e=this._initialAvailableSize,this._initialAvailableSize=null):e=l._Utility.computeContentSize(this.get__parentElement()),this._raiseVizResizeEvent(e),this._calculateFrameSize(e)},_refreshSize:function(){var e=this._getNewFrameSize();this._setFrameSize(e.width+"px",e.height+"px");for(var t=0;t<10;t++){var i=this._getNewFrameSize();if(JSON.stringify(e)===JSON.stringify(i))return;e=i,this._setFrameSize(e.width+"px",e.height+"px")}throw l._TableauException.create("maxVizResizeAttempts","Viz resize limit hit. The calculated iframe size did not stabilize after 10 resizes.")},handleEventNotification:function(e,t){var i=l._ApiServerNotification.deserialize(t);if("api.FirstVizSizeKnownEvent"===e){var n=JSON.parse(i.get_data());this._handleInitialVizSize(n)}else if("api.VizInteractiveEvent"===e)this._instanceId=i.get_data(),a.isValue(this._workbookImpl)&&this._workbookImpl.get_name()===i.get_workbookName()&&this._onWorkbookInteractive(),this._raiseStateReadyForQuery();else if("api.MarksSelectionChangedEvent"===e){if(null!=this.__marksSelection&&this._workbookImpl.get_name()===i.get_workbookName()){var r=null,o=this._workbookImpl.get_activeSheetImpl();if(o.get_name()===i.get_worksheetName())r=o;else if(o.get_isDashboard()){var s=o;r=s.get_worksheets()._get(i.get_worksheetName())._impl}a.isValue(r)&&(r.set_selectedMarks(null),this.__marksSelection(new l.MarksEvent("marksselection",this._viz,r)))}}else if("api.FilterChangedEvent"===e){if(null!=this.__filterChange&&this._workbookImpl.get_name()===i.get_workbookName()){var r=null,o=this._workbookImpl.get_activeSheetImpl();if(o.get_name()===i.get_worksheetName())r=o;else if(o.get_isDashboard()){var s=o;r=s.get_worksheets()._get(i.get_worksheetName())._impl}if(a.isValue(r)){var u=JSON.parse(i.get_data()),_=u[0],c=u[1];this.__filterChange(new l.FilterEvent("filterchange",this._viz,r,_,c))}}}else if("api.ParameterChangedEvent"===e){if(null!=this.__parameterValueChange&&this._workbookImpl.get_name()===i.get_workbookName()){this._workbookImpl.set__lastChangedParameterImpl(null);var m=i.get_data();this._raiseParameterValueChange(m)}}else if("api.CustomViewsListLoadedEvent"===e){var h=JSON.parse(i.get_data()),p=a.Delegate.create(this,function(){l._CustomViewImpl._processCustomViews(this._workbookImpl,this._messagingOptions,h)}),d=a.Delegate.create(this,function(){this._raiseCustomViewsListLoad(),null==this.__customViewLoad||h.customViewLoaded||this._raiseCustomViewLoad(this._workbookImpl.get_activeCustomView())});a.isNullOrUndefined(this._workbookImpl)?(this._initializingWorkbookImpl=!0,this._workbookImpl=new l._WorkbookImpl(this,this._messagingOptions,a.Delegate.create(this,function(){p(),this._onWorkbookInteractive(d),this._initializingWorkbookImpl=!1}))):(p(),this._ensureCalledAfterFirstInteractive(d))}else if("api.CustomViewUpdatedEvent"===e){var h=JSON.parse(i.get_data());if(a.isNullOrUndefined(this._workbookImpl)&&(this._workbookImpl=new l._WorkbookImpl(this,this._messagingOptions,a.Delegate.create(this,function(){this._onWorkbookInteractive()}))),a.isValue(this._workbookImpl)&&l._CustomViewImpl._processCustomViewUpdate(this._workbookImpl,this._messagingOptions,h,!0),null!=this.__customViewSave)for(var f=this._workbookImpl.get__updatedCustomViews()._toApiCollection(),g=0,v=f.length;g<v;g++)this._raiseCustomViewSave(f[g])}else if("api.CustomViewRemovedEvent"===e){if(null!=this.__customViewRemove)for(var w=this._workbookImpl.get__removedCustomViews()._toApiCollection(),g=0,v=w.length;g<v;g++)this._raiseCustomViewRemove(w[g])}else if("api.CustomViewSetDefaultEvent"===e){var h=JSON.parse(i.get_data());if(a.isValue(this._workbookImpl)&&l._CustomViewImpl._processCustomViews(this._workbookImpl,this._messagingOptions,h),null!=this.__customViewSetDefault)for(var f=this._workbookImpl.get__updatedCustomViews()._toApiCollection(),g=0,v=f.length;g<v;g++)this._raiseCustomViewSetDefault(f[g])}else if("api.TabSwitchEvent"===e)this._workbookImpl._update(a.Delegate.create(this,function(){if(a.isValue(this._workbookTabSwitchHandler)&&this._workbookTabSwitchHandler(),this._workbookImpl.get_name()===i.get_workbookName()){var e=i.get_worksheetName(),t=i.get_data();this._raiseTabSwitch(e,t)}this._onWorkbookInteractive()}));else if("api.StorytellingStateChangedEvent"===e){var y=this._workbookImpl.get_activeSheetImpl();"story"===y.get_sheetType()&&y.update(JSON.parse(i.get_data()))}},addEventListener:function(e,t){var i=l._enums._normalizeTableauEventName(e);if("marksselection"===i)this.add__marksSelection(t);else if("parametervaluechange"===i)this.add__parameterValueChange(t);else if("filterchange"===i)this.add__filterChange(t);else if("customviewload"===i)this.add__customViewLoad(t);else if("customviewsave"===i)this.add__customViewSave(t);else if("customviewremove"===i)this.add__customViewRemove(t);else if("customviewsetdefault"===i)this.add__customViewSetDefault(t);else if("tabswitch"===i)this.add__tabSwitch(t);else if("storypointswitch"===i)this.add__storyPointSwitch(t);else{if("vizresize"!==i)throw l._TableauException.createUnsupportedEventName(e);this.add__vizResize(t)}},removeEventListener:function(e,t){var i=l._enums._normalizeTableauEventName(e);if("marksselection"===i)this.remove__marksSelection(t);else if("parametervaluechange"===i)this.remove__parameterValueChange(t);else if("filterchange"===i)this.remove__filterChange(t);else if("customviewload"===i)this.remove__customViewLoad(t);else if("customviewsave"===i)this.remove__customViewSave(t);else if("customviewremove"===i)this.remove__customViewRemove(t);else if("customviewsetdefault"===i)this.remove__customViewSetDefault(t);else if("tabswitch"===i)this.remove__tabSwitch(t);else if("storypointswitch"===i)this.remove__storyPointSwitch(t);else{if("vizresize"!==i)throw l._TableauException.createUnsupportedEventName(e);this.remove__vizResize(t)}},_dispose:function(){a.isValue(this._iframe)&&(this._iframe.parentNode.removeChild(this._iframe),this._iframe=null),l._VizManagerImpl._unregisterViz(this._viz),this._messagingOptions.get_router().unregisterHandler(this),this._removeWindowResizeHandler()},_show:function(){this._iframe.style.display="block",this._iframe.style.visibility="visible"},_hide:function(){this._iframe.style.display="none"},_makeInvisible:function(){this._iframe.style.visibility="hidden"},_showExportImageDialog:function(){this._invokeCommand("showExportImageDialog")},_showExportDataDialog:function(e){var t=this._verifyOperationAllowedOnActiveSheetOrSheetWithinActiveDashboard(e);this._invokeCommand("showExportDataDialog",t)},_showExportCrossTabDialog:function(e){var t=this._verifyOperationAllowedOnActiveSheetOrSheetWithinActiveDashboard(e);this._invokeCommand("showExportCrosstabDialog",t)},_showExportPDFDialog:function(){this._invokeCommand("showExportPDFDialog")},_revertAllAsync:function(){var e=new l._Deferred,t=new l._CommandReturnHandler("api.RevertAllCommand",1,function(t){e.resolve()},function(t,i){e.reject(l._TableauException.createServerError(i))});return this._sendCommand(null,t),e.get_promise()},_refreshDataAsync:function(){var e=new l._Deferred,t=new l._CommandReturnHandler("api.RefreshDataCommand",1,function(t){e.resolve()},function(t,i){e.reject(l._TableauException.createServerError(i))});return this._sendCommand(null,t),e.get_promise()},_showShareDialog:function(){this._invokeCommand("showShareDialog")},_showDownloadWorkbookDialog:function(){if(!this.get__workbookImpl().get_isDownloadAllowed())throw l._TableauException.create("downloadWorkbookNotAllowed","Download workbook is not allowed");this._invokeCommand("showDownloadWorkbookDialog")},_pauseAutomaticUpdatesAsync:function(){return this._invokeAutomaticUpdatesCommandAsync("pauseAutomaticUpdates")},_resumeAutomaticUpdatesAsync:function(){return this._invokeAutomaticUpdatesCommandAsync("resumeAutomaticUpdates")},_toggleAutomaticUpdatesAsync:function(){return this._invokeAutomaticUpdatesCommandAsync("toggleAutomaticUpdates")},_setFrameSize:function(e,t){this._parameters.width=e,this._parameters.height=t,this._iframe.style.width=this._parameters.width,this._iframe.style.height=this._parameters.height},_setFrameSizeAndUpdate:function(e,t){this._raiseVizResizeEvent(l.$create_Size(-1,-1)),this._setFrameSize(e,t),this._workbookImpl._updateActiveSheetAsync()},_setAreAutomaticUpdatesPaused:function(e){this._areAutomaticUpdatesPaused=e},_contentRootElement:function(){return this._parameters.parentElement},_create:function(){try{l._VizManagerImpl._registerViz(this._viz)}catch(e){throw this._dispose(),e}this._parameters.fixedSize?(this._iframe=this._createIframe(),this._show()):(this._initialAvailableSize=l._Utility.computeContentSize(this.get__parentElement()),this._initialAvailableSize.width&&this._initialAvailableSize.height||(this._initialAvailableSize=l.$create_Size(800,600)),this._iframe=this._createIframe(),this._makeInvisible()),l._Utility.hasWindowPostMessage()||(l._Utility.isIE()?this._iframe.onreadystatechange=this._getOnCheckForDoneDelegate():this._iframe.onload=this._getOnCheckForDoneDelegate()),this._isToolbarHidden=!this._parameters.toolbar,this._areTabsHidden=!this._parameters.tabs,this._messagingOptions.get_router().registerHandler(this),this._iframe.src=this._parameters.get_url()},_sendVizOffset:function(){if(l._Utility.hasWindowPostMessage()&&!a.isNullOrUndefined(this._iframe)&&a.isValue(this._iframe.contentWindow)){var e=l._Utility.elementOffset(this._iframe),t=[];t.push("vizOffsetResp"),t.push(e.x),t.push(e.y),this._iframe.contentWindow.postMessage(t.join(","),"*")}},_sendCommand:function(e,t){this._messagingOptions.sendCommand(e,t)},_raiseParameterValueChange:function(e){null!=this.__parameterValueChange&&this.__parameterValueChange(new l.ParameterEvent("parametervaluechange",this._viz,e))},_raiseCustomViewLoad:function(e){null!=this.__customViewLoad&&this.__customViewLoad(new l.CustomViewEvent("customviewload",this._viz,a.isValue(e)?e._impl:null))},_raiseCustomViewSave:function(e){null!=this.__customViewSave&&this.__customViewSave(new l.CustomViewEvent("customviewsave",this._viz,e._impl))},_raiseCustomViewRemove:function(e){null!=this.__customViewRemove&&this.__customViewRemove(new l.CustomViewEvent("customviewremove",this._viz,e._impl))},_raiseCustomViewSetDefault:function(e){null!=this.__customViewSetDefault&&this.__customViewSetDefault(new l.CustomViewEvent("customviewsetdefault",this._viz,e._impl))},_raiseTabSwitch:function(e,t){null!=this.__tabSwitch&&this.__tabSwitch(new l.TabSwitchEvent("tabswitch",this._viz,e,t))},raiseStoryPointSwitch:function(e,t){null!=this.__storyPointSwitch&&this.__storyPointSwitch(new l.StoryPointSwitchEvent("storypointswitch",this._viz,e,t))},_raiseStateReadyForQuery:function(){null!=this.__stateReadyForQuery&&this.__stateReadyForQuery(this)},_raiseCustomViewsListLoad:function(){null!=this.__customViewsListLoad&&this.__customViewsListLoad(this)},_raiseVizResizeEvent:function(e){null!=this.__vizResize&&this.__vizResize(new l.VizResizeEvent("vizresize",this._viz,e))},_verifyOperationAllowedOnActiveSheetOrSheetWithinActiveDashboard:function(e){if(a.isNullOrUndefined(e))return null;var t=this._workbookImpl._findActiveSheetOrSheetWithinActiveDashboard(e);if(a.isNullOrUndefined(t))throw l._TableauException.createNotActiveSheet();return t.get_name()},_invokeAutomaticUpdatesCommandAsync:function(e){if("pauseAutomaticUpdates"!==e&&"resumeAutomaticUpdates"!==e&&"toggleAutomaticUpdates"!==e)throw l._TableauException.createInternalError(null);var t={};t["api.invokeCommandName"]=e;var i=new l._Deferred,n=new l._CommandReturnHandler("api.InvokeCommandCommand",0,a.Delegate.create(this,function(e){var t=e;a.isValue(t)&&a.isValue(t.isAutoUpdate)&&(this._areAutomaticUpdatesPaused=!t.isAutoUpdate),i.resolve(this._areAutomaticUpdatesPaused)}),function(e,t){i.reject(l._TableauException.createServerError(t))});return this._sendCommand(t,n),i.get_promise()},_invokeCommand:function(e,t){if("showExportImageDialog"!==e&&"showExportDataDialog"!==e&&"showExportCrosstabDialog"!==e&&"showExportPDFDialog"!==e&&"showShareDialog"!==e&&"showDownloadWorkbookDialog"!==e)throw l._TableauException.createInternalError(null);var i={};i["api.invokeCommandName"]=e,a.isValue(t)&&(i["api.invokeCommandParam"]=t);var n=new l._CommandReturnHandler("api.InvokeCommandCommand",0,null,null);this._sendCommand(i,n)},_onWorkbookInteractive:function(e){if(!this._onFirstInteractiveAlreadyCalled){var t=this._onFirstInteractiveCallback;window.setTimeout(a.Delegate.create(this,function(){a.isValue(t)&&t(new l.TableauEvent("firstinteractive",this._viz)),a.isValue(e)&&e()}),0),this._onFirstInteractiveAlreadyCalled=!0}this._raiseStateReadyForQuery()},_ensureCalledAfterFirstInteractive:function(e){var t=new Date,i=null;(i=a.Delegate.create(this,function(){var n=new Date;if(this._onFirstInteractiveAlreadyCalled)e();else{if(n-t>3e5)throw l._TableauException.createInternalError("Timed out while waiting for the viz to become interactive");window.setTimeout(i,10)}}))()},_checkForDone:function(){l._Utility.isIE()?"complete"===this._iframe.readyState&&this.handleVizLoad():this.handleVizLoad()},_onCheckForDone:function(){window.setTimeout(a.Delegate.create(this,this._checkForDone),3e3)},_createIframe:function(){if(a.isNullOrUndefined(this._contentRootElement()))return null;var e=document.createElement("IFrame");return e.frameBorder="0",e.setAttribute("allowTransparency","true"),e.marginHeight="0",e.marginWidth="0",e.style.display="block",this._parameters.fixedSize?(e.style.width=this._parameters.width,e.style.height=this._parameters.height):(e.style.width="1px",e.style.height="1px",e.setAttribute("scrolling","no")),l._Utility.isSafari()&&e.addEventListener("mousewheel",a.Delegate.create(this,this._onIframeMouseWheel),!1),this._contentRootElement().appendChild(e),e},_onIframeMouseWheel:function(e){},_getOnCheckForDoneDelegate:function(){return a.Delegate.create(this,function(e){this._onCheckForDone()})},_handleInitialVizSize:function(e){var t=l.SheetSizeFactory.fromSizeConstraints(e.sizeConstraints);this._vizSize=l.$create_VizSize(t,e.chromeHeight),a.isValue(this._onFirstVizSizeKnownCallback)&&this._onFirstVizSizeKnownCallback(new l.FirstVizSizeKnownEvent("firstvizsizeknown",this._viz,this._vizSize)),this._parameters.fixedSize||(this._refreshSize(),this._addWindowResizeHandler(),this._show())},_removeWindowResizeHandler:function(){a.isNullOrUndefined(this._windowResizeHandler)||(l._Utility.hasWindowAddEventListener()?window.removeEventListener("resize",this._windowResizeHandler,!1):window.self.detachEvent("onresize",this._windowResizeHandler),this._windowResizeHandler=null)},_addWindowResizeHandler:function(){a.isValue(this._windowResizeHandler)||(this._windowResizeHandler=a.Delegate.create(this,function(){this._refreshSize()}),l._Utility.hasWindowAddEventListener()?window.addEventListener("resize",this._windowResizeHandler,!1):window.self.attachEvent("onresize",this._windowResizeHandler))}},l._VizManagerImpl=function(){},l._VizManagerImpl.get__clonedVizs=function(){return l._VizManagerImpl._vizs.concat()},l._VizManagerImpl._registerViz=function(e){l._VizManagerImpl._verifyVizNotAlreadyParented(e),l._VizManagerImpl._vizs.push(e)},l._VizManagerImpl._unregisterViz=function(e){for(var t=0,i=l._VizManagerImpl._vizs.length;t<i;t++)if(l._VizManagerImpl._vizs[t]===e){l._VizManagerImpl._vizs.splice(t,1);break}},l._VizManagerImpl._sendVizOffsets=function(){for(var e=0,t=l._VizManagerImpl._vizs.length;e<t;e++)l._VizManagerImpl._vizs[e]._impl._sendVizOffset()},l._VizManagerImpl._verifyVizNotAlreadyParented=function(e){for(var t=e.getParentElement(),i=0,n=l._VizManagerImpl._vizs.length;i<n;i++)if(l._VizManagerImpl._vizs[i].getParentElement()===t){var r="Another viz is already present in element '"+l._Utility.elementToString(t)+"'.";throw l._TableauException.create("vizAlreadyInManager",r)}},l._VizParameters=function(e,t,i){if(a.isNullOrUndefined(e)||a.isNullOrUndefined(t))throw l._TableauException.create("noUrlOrParentElementNotFound","URL is empty or Parent element not found");a.isNullOrUndefined(i)&&(i={},i.hideTabs=!1,i.hideToolbar=!1,i.onFirstInteractive=null),a.isValue(i.height)||a.isValue(i.width)?(this.fixedSize=!0,l._Utility.isNumber(i.height)&&(i.height=i.height.toString()+"px"),l._Utility.isNumber(i.width)&&(i.width=i.width.toString()+"px"),this.height=a.isValue(i.height)?i.height.toString():null,this.width=a.isValue(i.width)?i.width.toString():null):this.fixedSize=!1,this.tabs=!i.hideTabs,this.toolbar=!i.hideToolbar,this.parentElement=e,this._createOptions=i,this.toolBarPosition=i.toolbarPosition;var n=t.split("?");this._urlFromApi=n[0],2===n.length?this.userSuppliedParameters=n[1]:this.userSuppliedParameters="";var r=new RegExp(".*?[^/:]/","").exec(this._urlFromApi);if(a.isNullOrUndefined(r)||-1===r[0].toLowerCase().indexOf("http://")&&-1===r[0].toLowerCase().indexOf("https://"))throw l._TableauException.create("invalidUrl","Invalid url");this.host_url=r[0].toLowerCase(),this.name=this._urlFromApi.replace(r[0],""),this.name=this.name.replace("views/",""),this.serverRoot=decodeURIComponent(this.host_url)},l._VizParameters.prototype={name:"",host_url:null,tabs:!1,toolbar:!1,toolBarPosition:null,handlerId:null,width:null,height:null,serverRoot:null,parentElement:null,userSuppliedParameters:null,fixedSize:!1,_urlFromApi:null,_createOptions:null,get_url:function(){return this._constructUrl()},get_baseUrl:function(){return this._urlFromApi},_constructUrl:function(){var e=[];e.push(this.get_baseUrl()),e.push("?"),this.userSuppliedParameters.length>0&&(e.push(this.userSuppliedParameters),e.push("&")),e.push(":embed=y"),e.push("&:showVizHome=n"),e.push("&:jsdebug=y"),this.fixedSize||e.push("&:bootstrapWhenNotified=y"),this.tabs||e.push("&:tabs=n"),this.toolbar?a.isNullOrUndefined(this.toolBarPosition)||(e.push("&:toolbar="),e.push(this.toolBarPosition)):e.push("&:toolbar=n");var t=this._createOptions,i=t;for(var n in i){var r={key:n,value:i[n]};"embed"!==r.key&&"height"!==r.key&&"width"!==r.key&&"autoSize"!==r.key&&"hideTabs"!==r.key&&"hideToolbar"!==r.key&&"onFirstInteractive"!==r.key&&"onFirstVizSizeKnown"!==r.key&&"toolbarPosition"!==r.key&&"instanceIdToClone"!==r.key&&(e.push("&"),e.push(encodeURIComponent(r.key)),e.push("="),e.push(encodeURIComponent(r.value.toString())))}return e.push("&:apiID="+this.handlerId),a.isValue(this._createOptions.instanceIdToClone)&&e.push("#"+this._createOptions.instanceIdToClone),e.join("")}},l._WorkbookImpl=function(e,t,i){this._publishedSheetsInfo=new l._Collection,this._customViews=new l._Collection,this._updatedCustomViews=new l._Collection,this._removedCustomViews=new l._Collection,this._vizImpl=e,this._messagingOptions=t,this._getClientInfo(i)},l._WorkbookImpl._createDashboardZones=function(e){e=e||[];for(var t=[],i=0;i<e.length;i++){var n=e[i],r=n.zoneType,a=l.$create_Size(n.width,n.height),o=l.$create_Point(n.x,n.y),s=n.name,u=l.$create__dashboardZoneInfo(s,r,o,a,n.zoneId);t.push(u)}return t},l._WorkbookImpl._extractSheetName=function(e){if(a.isNullOrUndefined(e))return null;if(l._Utility.isString(e))return e;var t=e,i=a.Delegate.create(t,t.getName);return a.isValue(i)?i():null},l._WorkbookImpl._createSheetSize=function(e){return a.isNullOrUndefined(e)?l.SheetSizeFactory.createAutomatic():l.SheetSizeFactory.fromSizeConstraints(e.sizeConstraints)},l._WorkbookImpl._processParameters=function(e){for(var t=new l._Collection,i=a.IEnumerator.getEnumerator(e.parameters);i.moveNext();){var n=i.current,r=new l._parameterImpl(n);t._add(r.get__name(),r.get__parameter())}return t},l._WorkbookImpl._findAndCreateParameterImpl=function(e,t){for(var i=a.IEnumerator.getEnumerator(t.parameters);i.moveNext();){var n=i.current;if(n.name===e)return new l._parameterImpl(n)}return null},l._WorkbookImpl.prototype={_workbook:null,_vizImpl:null,_name:null,_activeSheetImpl:null,_activatingHiddenSheetImpl:null,_isDownloadAllowed:!1,_messagingOptions:null,get_workbook:function(){return a.isNullOrUndefined(this._workbook)&&(this._workbook=new r.Workbook(this)),this._workbook},get_viz:function(){return this._vizImpl.get__viz()},get_publishedSheets:function(){return this._publishedSheetsInfo},get_name:function(){return this._name},get_activeSheetImpl:function(){return this._activeSheetImpl},get_activeCustomView:function(){return this._currentCustomView},get_isDownloadAllowed:function(){return this._isDownloadAllowed},_findActiveSheetOrSheetWithinActiveDashboard:function(e){if(a.isNullOrUndefined(this._activeSheetImpl))return null;var t=l._WorkbookImpl._extractSheetName(e);if(a.isNullOrUndefined(t))return null;if(t===this._activeSheetImpl.get_name())return this._activeSheetImpl;if(this._activeSheetImpl.get_isDashboard()){var i=this._activeSheetImpl,n=i.get_worksheets()._get(t);if(a.isValue(n))return n._impl}return null},_setActiveSheetAsync:function(e){if(l._Utility.isNumber(e)){var t=e;if(t<this._publishedSheetsInfo.get__length()&&t>=0)return this._activateSheetWithInfoAsync(this._publishedSheetsInfo.get_item(t)._impl);throw l._TableauException.createIndexOutOfRange(t)}var i=l._WorkbookImpl._extractSheetName(e),n=this._publishedSheetsInfo._get(i);if(a.isValue(n))return this._activateSheetWithInfoAsync(n._impl);if(this._activeSheetImpl.get_isDashboard()){var r=this._activeSheetImpl,o=r.get_worksheets()._get(i);if(a.isValue(o)){this._activatingHiddenSheetImpl=null;var s="";return o.getIsHidden()?this._activatingHiddenSheetImpl=o._impl:s=o._impl.get_url(),this._activateSheetInternalAsync(o._impl.get_name(),s)}}throw l._TableauException.create("sheetNotInWorkbook","Sheet is not found in Workbook")},_revertAllAsync:function(){var e=new l._Deferred,t=new l._CommandReturnHandler("api.RevertAllCommand",1,function(t){e.resolve()},function(t,i){e.reject(l._TableauException.createServerError(i))});return this._sendCommand(null,t),e.get_promise()},_update:function(e){this._getClientInfo(e)},_activateSheetWithInfoAsync:function(e){return this._activateSheetInternalAsync(e.name,e.url)},_activateSheetInternalAsync:function(e,t){var i=new l._Deferred;if(a.isValue(this._activeSheetImpl)&&e===this._activeSheetImpl.get_name())return i.resolve(this._activeSheetImpl.get_sheet()),i.get_promise();var n={};n["api.switchToSheetName"]=e,n["api.switchToRepositoryUrl"]=t,n["api.oldRepositoryUrl"]=this._activeSheetImpl.get_url();var r=new l._CommandReturnHandler("api.SwitchActiveSheetCommand",0,a.Delegate.create(this,function(e){this._vizImpl._workbookTabSwitchHandler=a.Delegate.create(this,function(){this._vizImpl._workbookTabSwitchHandler=null,i.resolve(this._activeSheetImpl.get_sheet())})}),function(e,t){i.reject(l._TableauException.createServerError(t))});return this._sendCommand(n,r),i.get_promise()},_updateActiveSheetAsync:function(){var e=new l._Deferred,t={};t["api.switchToSheetName"]=this._activeSheetImpl.get_name(),t["api.switchToRepositoryUrl"]=this._activeSheetImpl.get_url(),t["api.oldRepositoryUrl"]=this._activeSheetImpl.get_url();var i=new l._CommandReturnHandler("api.UpdateActiveSheetCommand",0,a.Delegate.create(this,function(t){e.resolve(this._activeSheetImpl.get_sheet())}),function(t,i){e.reject(l._TableauException.createServerError(i))});return this._sendCommand(t,i),e.get_promise()},_sendCommand:function(e,t){this._messagingOptions.sendCommand(e,t)},_getClientInfo:function(e){var t=new l._CommandReturnHandler("api.GetClientInfoCommand",0,a.Delegate.create(this,function(t){var i=t;this._processInfo(i),a.isValue(e)&&e()}),null);this._sendCommand(null,t)},_processInfo:function(e){this._name=e.workbookName,this._isDownloadAllowed=e.isDownloadAllowed,this._vizImpl._setAreAutomaticUpdatesPaused(!e.isAutoUpdate),this._createSheetsInfo(e),this._initializeActiveSheet(e)},_initializeActiveSheet:function(e){var t=e.currentSheetName,i=this._publishedSheetsInfo._get(t);if(a.isNullOrUndefined(i)&&a.isNullOrUndefined(this._activatingHiddenSheetImpl))throw l._TableauException.createInternalError("The active sheet was not specified in baseSheets");if(!a.isValue(this._activeSheetImpl)||this._activeSheetImpl.get_name()!==t){if(a.isValue(this._activeSheetImpl)){this._activeSheetImpl.set_isActive(!1);var n=this._publishedSheetsInfo._get(this._activeSheetImpl.get_name());if(a.isValue(n)&&(n._impl.isActive=!1),"story"===this._activeSheetImpl.get_sheetType()){var r=this._activeSheetImpl;r.remove_activeStoryPointChange(a.Delegate.create(this._vizImpl,this._vizImpl.raiseStoryPointSwitch))}}if(a.isValue(this._activatingHiddenSheetImpl)){var o=l.$create__SheetInfoImpl(this._activatingHiddenSheetImpl.get_name(),"worksheet",-1,this._activatingHiddenSheetImpl.get_size(),this.get_workbook(),"",!0,!0,4294967295);this._activatingHiddenSheetImpl=null,this._activeSheetImpl=new l._WorksheetImpl(o,this,this._messagingOptions,null)}else{for(var s=null,u=0,_=e.publishedSheets.length;u<_;u++)if(e.publishedSheets[u].name===t){s=e.publishedSheets[u];break}if(a.isNullOrUndefined(s))throw l._TableauException.createInternalError("No base sheet was found corresponding to the active sheet.");var c=a.Delegate.create(this,function(e){return this._publishedSheetsInfo._get(e)});if("dashboard"===s.sheetType){var m=new l._DashboardImpl(i._impl,this,this._messagingOptions);this._activeSheetImpl=m;var h=l._WorkbookImpl._createDashboardZones(e.dashboardZones);m._addObjects(h,c)}else if("story"===s.sheetType){var r=new l._StoryImpl(i._impl,this,this._messagingOptions,e.story,c);this._activeSheetImpl=r,r.add_activeStoryPointChange(a.Delegate.create(this._vizImpl,this._vizImpl.raiseStoryPointSwitch))}else this._activeSheetImpl=new l._WorksheetImpl(i._impl,this,this._messagingOptions,null);i._impl.isActive=!0}this._activeSheetImpl.set_isActive(!0)}},_createSheetsInfo:function(e){var t=e.publishedSheets;if(!a.isNullOrUndefined(t))for(var i=0;i<t.length;i++){var n=t[i],o=n.name,s=this._publishedSheetsInfo._get(o),u=l._WorkbookImpl._createSheetSize(n);if(a.isNullOrUndefined(s)){var _=o===e.currentSheetName,c=n.sheetType,m=l.$create__SheetInfoImpl(o,c,i,u,this.get_workbook(),n.repositoryUrl,_,!1,4294967295);s=new r.SheetInfo(m),this._publishedSheetsInfo._add(o,s)}else s._impl.size=u}},_currentCustomView:null,get__customViews:function(){return this._customViews},set__customViews:function(e){return this._customViews=e,e},get__updatedCustomViews:function(){return this._updatedCustomViews},set__updatedCustomViews:function(e){return this._updatedCustomViews=e,e},get__removedCustomViews:function(){return this._removedCustomViews},set__removedCustomViews:function(e){return this._removedCustomViews=e,e},get__currentCustomView:function(){return this._currentCustomView},set__currentCustomView:function(e){return this._currentCustomView=e,e},_getCustomViewsAsync:function(){return l._CustomViewImpl._getCustomViewsAsync(this,this._messagingOptions)},_showCustomViewAsync:function(e){if(a.isNullOrUndefined(e)||l._Utility.isNullOrEmpty(e))return l._CustomViewImpl._showCustomViewAsync(this,this._messagingOptions,null);var t=this._customViews._get(e);if(a.isNullOrUndefined(t)){var i=new l._Deferred;return i.reject(l._TableauException.createInvalidCustomViewName(e)),i.get_promise()}return t._impl._showAsync()},_removeCustomViewAsync:function(e){if(l._Utility.isNullOrEmpty(e))throw l._TableauException.createNullOrEmptyParameter("customViewName");var t=this._customViews._get(e);if(a.isNullOrUndefined(t)){var i=new l._Deferred;return i.reject(l._TableauException.createInvalidCustomViewName(e)),i.get_promise()}return t._impl._removeAsync()},_rememberCustomViewAsync:function(e){if(l._Utility.isNullOrEmpty(e))throw l._TableauException.createInvalidParameter("customViewName");return l._CustomViewImpl._saveNewAsync(this,this._messagingOptions,e)},_setActiveCustomViewAsDefaultAsync:function(){return l._CustomViewImpl._makeCurrentCustomViewDefaultAsync(this,this._messagingOptions)},_parameters:null,_lastChangedParameterImpl:null,get__lastChangedParameterImpl:function(){return this._lastChangedParameterImpl},set__lastChangedParameterImpl:function(e){return this._lastChangedParameterImpl=e,e},get__parameters:function(){return this._parameters},_getSingleParameterAsync:function(e){var t=new l._Deferred;if(a.isValue(this._lastChangedParameterImpl))return t.resolve(this._lastChangedParameterImpl.get__parameter()),t.get_promise();var i={},n=new l._CommandReturnHandler("api.FetchParametersCommand",0,a.Delegate.create(this,function(i){var n=i,r=l._WorkbookImpl._findAndCreateParameterImpl(e,n);this._lastChangedParameterImpl=r,t.resolve(r.get__parameter())}),function(e,i){t.reject(l._TableauException.createServerError(i))});return this._sendCommand(i,n),t.get_promise()},_getParametersAsync:function(){var e=new l._Deferred,t={},i=new l._CommandReturnHandler("api.FetchParametersCommand",0,a.Delegate.create(this,function(t){var i=t;this._parameters=l._WorkbookImpl._processParameters(i),e.resolve(this.get__parameters()._toApiCollection())}),function(t,i){e.reject(l._TableauException.createServerError(i))});return this._sendCommand(t,i),e.get_promise()},_changeParameterValueAsync:function(e,t){var i=new l._Deferred,n=null;if(a.isValue(this._parameters)){if(a.isNullOrUndefined(this._parameters._get(e)))return i.reject(l._TableauException.createInvalidParameter(e)),i.get_promise();if(n=this._parameters._get(e)._impl,a.isNullOrUndefined(n))return i.reject(l._TableauException.createInvalidParameter(e)),i.get_promise()}var r={};if(r["api.setParameterName"]=a.isValue(this._parameters)?n.get__name():e,a.isValue(t)&&l._Utility.isDate(t)){var o=t,s=l._Utility.serializeDateForServer(o);r["api.setParameterValue"]=s}else r["api.setParameterValue"]=a.isValue(t)?t.toString():null;this._lastChangedParameterImpl=null;var u=new l._CommandReturnHandler("api.SetParameterValueCommand",0,a.Delegate.create(this,function(t){var n=t;if(a.isNullOrUndefined(n))return void i.reject(l._TableauException.create("serverError","server error"));if(!n.isValidPresModel)return void i.reject(l._TableauException.createInvalidParameter(e));var r=new l._parameterImpl(n);this._lastChangedParameterImpl=r,i.resolve(r.get__parameter())}),function(t,n){i.reject(l._TableauException.createInvalidParameter(e))});return this._sendCommand(r,u),i.get_promise()}},l._WorksheetImpl=function(e,t,i,n){this._filters$1=new l._Collection,this._selectedMarks$1=new l._Collection,l._WorksheetImpl.initializeBase(this,[e,t,i]),this._parentDashboardImpl$1=n},l._WorksheetImpl._filterCommandError=function(e){var t=e;if(a.isValue(t)&&a.isValue(t.errorCode)){var i=t.additionalInformation;switch(t.errorCode){case"invalidFilterFieldName":case"invalidFilterFieldValue":return l._TableauException.create(t.errorCode,i);case"invalidAggregationFieldName":return l._TableauException._createInvalidAggregationFieldName(i);default:return l._TableauException.createServerError(i)}}return null},l._WorksheetImpl._normalizeRangeFilterOption$1=function(e){if(a.isNullOrUndefined(e))throw l._TableauException.createNullOrEmptyParameter("filterOptions");if(a.isNullOrUndefined(e.min)&&a.isNullOrUndefined(e.max))throw l._TableauException.create("invalidParameter","At least one of filterOptions.min or filterOptions.max must be specified.");var t={};return a.isValue(e.min)&&(t.min=e.min),a.isValue(e.max)&&(t.max=e.max),a.isValue(e.nullOption)&&(t.nullOption=l._enums._normalizeNullOption(e.nullOption,"filterOptions.nullOption")),t},l._WorksheetImpl._normalizeRelativeDateFilterOptions$1=function(e){if(a.isNullOrUndefined(e))throw l._TableauException.createNullOrEmptyParameter("filterOptions");var t={};if(t.rangeType=l._enums._normalizeDateRangeType(e.rangeType,"filterOptions.rangeType"),t.periodType=l._enums._normalizePeriodType(e.periodType,"filterOptions.periodType"),"lastn"===t.rangeType||"nextn"===t.rangeType){if(a.isNullOrUndefined(e.rangeN))throw l._TableauException.create("missingRangeNForRelativeDateFilters","Missing rangeN field for a relative date filter of LASTN or NEXTN.");t.rangeN=l._Utility.toInt(e.rangeN)}if(a.isValue(e.anchorDate)){if(!l._Utility.isDate(e.anchorDate)||!l._Utility.isDateValid(e.anchorDate))throw l._TableauException.createInvalidDateParameter("filterOptions.anchorDate");t.anchorDate=e.anchorDate}return t},l._WorksheetImpl._createFilterCommandReturnHandler$1=function(e,t,i){return new l._CommandReturnHandler(e,1,function(e){var n=l._WorksheetImpl._filterCommandError(e);null==n?i.resolve(t):i.reject(n)},function(e,n){if(e)i.reject(l._TableauException.createInvalidFilterFieldNameOrValue(t));else{var r=l._TableauException.create("filterCannotBePerformed",n);i.reject(r)}})},l._WorksheetImpl._createSelectionCommandError$1=function(e){var t=e;if(a.isValue(t)&&a.isValue(t.errorCode)){var i=t.additionalInformation;switch(t.errorCode){case"invalidSelectionFieldName":case"invalidSelectionValue":case"invalidSelectionDate":return l._TableauException.create(t.errorCode,i)}}return null},l._WorksheetImpl.prototype={_worksheet$1:null,_parentDashboardImpl$1:null,get_sheet:function(){return this.get_worksheet()},get_worksheet:function(){return null==this._worksheet$1&&(this._worksheet$1=new r.Worksheet(this)),this._worksheet$1},get_parentDashboardImpl:function(){return this._parentDashboardImpl$1},get_parentDashboard:function(){return a.isValue(this._parentDashboardImpl$1)?this._parentDashboardImpl$1.get_dashboard():null},_getDataSourcesAsync:function(){this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();var e=new l._Deferred,t={};t["api.worksheetName"]=this.get_name();var i=new l._CommandReturnHandler("api.GetDataSourcesCommand",0,function(t){var i=t,n=l._DataSourceImpl.processDataSourcesForWorksheet(i);e.resolve(n._toApiCollection())},function(t,i){e.reject(l._TableauException.createServerError(i))});return this.sendCommand(t,i),e.get_promise()},_getDataSourceAsync:function(e){this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();var t=new l._Deferred,i={};i["api.dataSourceName"]=e,i["api.worksheetName"]=this.get_name();var n=new l._CommandReturnHandler("api.GetDataSourceCommand",0,function(i){var n=i,r=l._DataSourceImpl.processDataSource(n);a.isValue(r)?t.resolve(r.get_dataSource()):t.reject(l._TableauException.createServerError("Data source '"+e+"' not found"))},function(e,i){t.reject(l._TableauException.createServerError(i))});return this.sendCommand(i,n),t.get_promise()},_verifyActiveSheetOrEmbeddedInActiveDashboard$1:function(){var e=this.get_isActive(),t=a.isValue(this._parentDashboardImpl$1)&&this._parentDashboardImpl$1.get_isActive(),i=a.isValue(this.get_parentStoryPointImpl())&&this.get_parentStoryPointImpl().get_parentStoryImpl().get_isActive();if(!e&&!t&&!i)throw l._TableauException.createNotActiveSheet()},_addVisualIdToCommand$1:function(e){if(a.isValue(this.get_parentStoryPointImpl())){var t={};t.worksheet=this.get_name(),a.isValue(this.get_parentDashboardImpl())&&(t.dashboard=this.get_parentDashboardImpl().get_name()),t.flipboardZoneId=this.get_parentStoryPointImpl().get_containedSheetImpl().get_zoneId(),t.storyboard=this.get_parentStoryPointImpl().get_parentStoryImpl().get_name(),t.storyPointId=this.get_parentStoryPointImpl().get_storyPointId(),e["api.visualId"]=t}else e["api.worksheetName"]=this.get_name(),a.isValue(this.get_parentDashboardImpl())&&(e["api.dashboardName"]=this.get_parentDashboardImpl().get_name())},get__filters:function(){return this._filters$1},set__filters:function(e){return this._filters$1=e,e},_getFilterAsync:function(e,t,i){if(!l._Utility.isNullOrEmpty(e)&&!l._Utility.isNullOrEmpty(t))throw l._TableauException.createInternalError("Only fieldName OR fieldCaption is allowed, not both.");i=i||{};var n=new l._Deferred,o={};this._addVisualIdToCommand$1(o),!l._Utility.isNullOrEmpty(t)&&l._Utility.isNullOrEmpty(e)&&(o["api.fieldCaption"]=t),l._Utility.isNullOrEmpty(e)||(o["api.fieldName"]=e),o["api.filterHierarchicalLevels"]=0,o["api.ignoreDomain"]=i.ignoreDomain||!1;var s=new l._CommandReturnHandler("api.GetOneFilterInfoCommand",0,a.Delegate.create(this,function(e){var t=l._WorksheetImpl._filterCommandError(e);if(null==t){var i=e,a=r.Filter._createFilter(this,i);n.resolve(a)}else n.reject(t)}),function(e,t){n.reject(l._TableauException.createServerError(t))});return this.sendCommand(o,s),n.get_promise()},_getFiltersAsync:function(e){this._verifyActiveSheetOrEmbeddedInActiveDashboard$1(),e=e||{};var t=new l._Deferred,i={};this._addVisualIdToCommand$1(i),i["api.ignoreDomain"]=e.ignoreDomain||!1;var n=new l._CommandReturnHandler("api.GetFiltersListCommand",0,a.Delegate.create(this,function(e){var i=e;this.set__filters(r.Filter._processFiltersList(this,i)),t.resolve(this.get__filters()._toApiCollection())}),function(e,i){t.reject(l._TableauException.createServerError(i))});return this.sendCommand(i,n),t.get_promise()},_applyFilterAsync:function(e,t,i,n){return this._applyFilterWithValuesInternalAsync$1(e,t,i,n)},_clearFilterAsync:function(e){return this._clearFilterInternalAsync$1(e)},_applyRangeFilterAsync:function(e,t){var i=l._WorksheetImpl._normalizeRangeFilterOption$1(t);return this._applyRangeFilterInternalAsync$1(e,i)},_applyRelativeDateFilterAsync:function(e,t){var i=l._WorksheetImpl._normalizeRelativeDateFilterOptions$1(t);return this._applyRelativeDateFilterInternalAsync$1(e,i)},_applyHierarchicalFilterAsync:function(e,t,i,n){if(a.isNullOrUndefined(t)&&"all"!==i)throw l._TableauException.createInvalidParameter("values");return this._applyHierarchicalFilterInternalAsync$1(e,t,i,n)},_clearFilterInternalAsync$1:function(e){if(this._verifyActiveSheetOrEmbeddedInActiveDashboard$1(),l._Utility.isNullOrEmpty(e))throw l._TableauException.createNullOrEmptyParameter("fieldName");var t=new l._Deferred,i={};i["api.fieldCaption"]=e,this._addVisualIdToCommand$1(i);var n=l._WorksheetImpl._createFilterCommandReturnHandler$1("api.ClearFilterCommand",e,t);return this.sendCommand(i,n),t.get_promise()},_applyFilterWithValuesInternalAsync$1:function(e,t,i,n){if(this._verifyActiveSheetOrEmbeddedInActiveDashboard$1(),l._Utility.isNullOrEmpty(e))throw l._TableauException.createNullOrEmptyParameter("fieldName");i=l._enums._normalizeFilterUpdateType(i,"updateType");var r=[];if(l._jQueryShim.isArray(t))for(var o=0;o<t.length;o++)r.push(t[o].toString());else a.isValue(t)&&r.push(t.toString());var s=new l._Deferred,u={};u["api.fieldCaption"]=e,u["api.filterUpdateType"]=i,u["api.exclude"]=!(!a.isValue(n)||!n.isExcludeMode),"all"!==i&&(u["api.filterCategoricalValues"]=r),this._addVisualIdToCommand$1(u);var _=l._WorksheetImpl._createFilterCommandReturnHandler$1("api.ApplyCategoricalFilterCommand",e,s);return this.sendCommand(u,_),s.get_promise()},_applyRangeFilterInternalAsync$1:function(e,t){if(this._verifyActiveSheetOrEmbeddedInActiveDashboard$1(),l._Utility.isNullOrEmpty(e))throw l._TableauException.createNullOrEmptyParameter("fieldName");if(a.isNullOrUndefined(t))throw l._TableauException.createNullOrEmptyParameter("filterOptions");var i={};if(i["api.fieldCaption"]=e,a.isValue(t.min))if(l._Utility.isDate(t.min)){var n=t.min;if(!l._Utility.isDateValid(n))throw l._TableauException.createInvalidDateParameter("filterOptions.min");i["api.filterRangeMin"]=l._Utility.serializeDateForServer(n)}else i["api.filterRangeMin"]=t.min;if(a.isValue(t.max))if(l._Utility.isDate(t.max)){var n=t.max;if(!l._Utility.isDateValid(n))throw l._TableauException.createInvalidDateParameter("filterOptions.max");i["api.filterRangeMax"]=l._Utility.serializeDateForServer(n)}else i["api.filterRangeMax"]=t.max;a.isValue(t.nullOption)&&(i["api.filterRangeNullOption"]=t.nullOption),this._addVisualIdToCommand$1(i);var r=new l._Deferred,o=l._WorksheetImpl._createFilterCommandReturnHandler$1("api.ApplyRangeFilterCommand",e,r);return this.sendCommand(i,o),r.get_promise()},_applyRelativeDateFilterInternalAsync$1:function(e,t){if(this._verifyActiveSheetOrEmbeddedInActiveDashboard$1(),l._Utility.isNullOrEmpty(e))throw l._TableauException.createInvalidParameter("fieldName");if(a.isNullOrUndefined(t))throw l._TableauException.createInvalidParameter("filterOptions");var i={};if(i["api.fieldCaption"]=e,a.isValue(t)){if(i["api.filterPeriodType"]=t.periodType,i["api.filterDateRangeType"]=t.rangeType,"lastn"===t.rangeType||"nextn"===t.rangeType){if(a.isNullOrUndefined(t.rangeN))throw l._TableauException.create("missingRangeNForRelativeDateFilters","Missing rangeN field for a relative date filter of LASTN or NEXTN.");i["api.filterDateRange"]=t.rangeN}a.isValue(t.anchorDate)&&(i["api.filterDateArchorValue"]=l._Utility.serializeDateForServer(t.anchorDate))}this._addVisualIdToCommand$1(i);var n=new l._Deferred,r=l._WorksheetImpl._createFilterCommandReturnHandler$1("api.ApplyRelativeDateFilterCommand",e,n);return this.sendCommand(i,r),n.get_promise()},_applyHierarchicalFilterInternalAsync$1:function(e,t,i,n){if(this._verifyActiveSheetOrEmbeddedInActiveDashboard$1(),l._Utility.isNullOrEmpty(e))throw l._TableauException.createNullOrEmptyParameter("fieldName");i=l._enums._normalizeFilterUpdateType(i,"updateType");var r=null,o=null;if(l._jQueryShim.isArray(t)){r=[];for(var s=t,u=0;u<s.length;u++)r.push(s[u].toString())}else if(l._Utility.isString(t))r=[],r.push(t.toString());else if(a.isValue(t)&&a.isValue(t.levels)){var _=t.levels;if(o=[],l._jQueryShim.isArray(_))for(var c=_,u=0;u<c.length;u++)o.push(c[u].toString());else o.push(_.toString())}else if(a.isValue(t))throw l._TableauException.createInvalidParameter("values");var m={};m["api.fieldCaption"]=e,m["api.filterUpdateType"]=i,m["api.exclude"]=!(!a.isValue(n)||!n.isExcludeMode),null!=r&&(m["api.filterHierarchicalValues"]=l.JsonUtil.toJson(r,!1,"")),null!=o&&(m["api.filterHierarchicalLevels"]=l.JsonUtil.toJson(o,!1,"")),this._addVisualIdToCommand$1(m);var h=new l._Deferred,p=l._WorksheetImpl._createFilterCommandReturnHandler$1("api.ApplyHierarchicalFilterCommand",e,h);return this.sendCommand(m,p),h.get_promise()},get_selectedMarks:function(){return this._selectedMarks$1},set_selectedMarks:function(e){return this._selectedMarks$1=e,e},_clearSelectedMarksAsync:function(){this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();var e=new l._Deferred,t={};this._addVisualIdToCommand$1(t),t["api.filterUpdateType"]="replace";var i=new l._CommandReturnHandler("api.SelectMarksCommand",1,function(t){e.resolve()},function(t,i){e.reject(l._TableauException.createServerError(i))});return this.sendCommand(t,i),e.get_promise()},_selectMarksAsync:function(e,t,i){return this._verifyActiveSheetOrEmbeddedInActiveDashboard$1(),null==e&&null==t?this._clearSelectedMarksAsync():l._Utility.isString(e)&&(l._jQueryShim.isArray(t)||l._Utility.isString(t)||!l._enums._isSelectionUpdateType(t))?this._selectMarksWithFieldNameAndValueAsync$1(e,t,i):l._jQueryShim.isArray(e)?this._selectMarksWithMarksArrayAsync$1(e,t):this._selectMarksWithMultiDimOptionAsync$1(e,t)},_getSelectedMarksAsync:function(){this._verifyActiveSheetOrEmbeddedInActiveDashboard$1();var e=new l._Deferred,t={};this._addVisualIdToCommand$1(t);var i=new l._CommandReturnHandler("api.FetchSelectedMarksCommand",0,a.Delegate.create(this,function(t){var i=t;this._selectedMarks$1=l._markImpl._processSelectedMarks(i),e.resolve(this._selectedMarks$1._toApiCollection())}),function(t,i){e.reject(l._TableauException.createServerError(i))});return this.sendCommand(t,i),e.get_promise()},_selectMarksWithFieldNameAndValueAsync$1:function(e,t,i){var n=[],r=[],a=[],o=[],s=[],l=[];return this._parseMarksParam$1(n,r,a,o,s,l,e,t),this._selectMarksWithValuesAsync$1(null,n,r,a,o,s,l,i)},_selectMarksWithMultiDimOptionAsync$1:function(e,t){var i=e,n=[],r=[],a=[],o=[],s=[],u=[],_=i;for(var c in _){var m={key:c,value:_[c]};e.hasOwnProperty(m.key)&&(l._jQueryShim.isFunction(i[m.key])||this._parseMarksParam$1(n,r,a,o,s,u,m.key,m.value))}return this._selectMarksWithValuesAsync$1(null,n,r,a,o,s,u,t)},_selectMarksWithMarksArrayAsync$1:function(e,t){for(var i=[],n=[],r=[],o=[],s=[],u=[],_=[],c=0;c<e.length;c++){var m=e[c];if(a.isValue(m._impl.get__tupleId())&&m._impl.get__tupleId()>0)_.push(m._impl.get__tupleId());else for(var h=m._impl.get__pairs(),p=0;p<h.get__length();p++){var d=h.get_item(p);d.hasOwnProperty("fieldName")&&d.hasOwnProperty("value")&&!l._jQueryShim.isFunction(d.fieldName)&&!l._jQueryShim.isFunction(d.value)&&this._parseMarksParam$1(i,n,r,o,s,u,d.fieldName,d.value)}}return this._selectMarksWithValuesAsync$1(_,i,n,r,o,s,u,t)},_parseMarksParam$1:function(e,t,i,n,r,o,s,u){var _=u;if(l._WorksheetImpl._regexHierarchicalFieldName$1.test(s))this._addToParamLists$1(i,n,s,u);else if(a.isValue(_.min)||a.isValue(_.max)){var c={};if(a.isValue(_.min))if(l._Utility.isDate(_.min)){var m=_.min;if(!l._Utility.isDateValid(m))throw l._TableauException.createInvalidDateParameter("options.min");c.min=l._Utility.serializeDateForServer(m)}else c.min=_.min;if(a.isValue(_.max))if(l._Utility.isDate(_.max)){var m=_.max;if(!l._Utility.isDateValid(m))throw l._TableauException.createInvalidDateParameter("options.max");c.max=l._Utility.serializeDateForServer(m)}else c.max=_.max;if(a.isValue(_.nullOption)){var h=l._enums._normalizeNullOption(_.nullOption,"options.nullOption");c.nullOption=h}else c.nullOption="allValues";var p=l.JsonUtil.toJson(c,!1,"");this._addToParamLists$1(r,o,s,p)}else this._addToParamLists$1(e,t,s,u)},_addToParamLists$1:function(e,t,i,n){var r=[];if(l._jQueryShim.isArray(n))for(var a=n,o=0;o<a.length;o++)r.push(a[o]);else r.push(n);t.push(r),e.push(i)},_selectMarksWithValuesAsync$1:function(e,t,i,n,r,a,o,s){var u={};if(this._addVisualIdToCommand$1(u),s=l._enums._normalizeSelectionUpdateType(s,"updateType"),u["api.filterUpdateType"]=s,l._Utility.isNullOrEmpty(e)||(u["api.tupleIds"]=l.JsonUtil.toJson(e,!1,"")),!l._Utility.isNullOrEmpty(t)&&!l._Utility.isNullOrEmpty(i)){u["api.categoricalFieldCaption"]=l.JsonUtil.toJson(t,!1,"");for(var _=[],c=0;c<i.length;c++){var m=l.JsonUtil.toJson(i[c],!1,"");_.push(m)}u["api.categoricalMarkValues"]=l.JsonUtil.toJson(_,!1,"")}if(!l._Utility.isNullOrEmpty(n)&&!l._Utility.isNullOrEmpty(r)){u["api.hierarchicalFieldCaption"]=l.JsonUtil.toJson(n,!1,"");for(var _=[],c=0;c<r.length;c++){var m=l.JsonUtil.toJson(r[c],!1,"");_.push(m)}u["api.hierarchicalMarkValues"]=l.JsonUtil.toJson(_,!1,"")}if(!l._Utility.isNullOrEmpty(a)&&!l._Utility.isNullOrEmpty(o)){u["api.rangeFieldCaption"]=l.JsonUtil.toJson(a,!1,"");for(var _=[],c=0;c<o.length;c++){var m=l.JsonUtil.toJson(o[c],!1,"");_.push(m)}u["api.rangeMarkValues"]=l.JsonUtil.toJson(_,!1,"")}if(l._Utility.isNullOrEmpty(u["api.tupleIds"])&&l._Utility.isNullOrEmpty(u["api.categoricalFieldCaption"])&&l._Utility.isNullOrEmpty(u["api.hierarchicalFieldCaption"])&&l._Utility.isNullOrEmpty(u["api.rangeFieldCaption"]))throw l._TableauException.createInvalidParameter("fieldNameOrFieldValuesMap");var h=new l._Deferred,p=new l._CommandReturnHandler("api.SelectMarksCommand",1,function(e){var t=l._WorksheetImpl._createSelectionCommandError$1(e);null==t?h.resolve():h.reject(t)},function(e,t){h.reject(l._TableauException.createServerError(t))});return this.sendCommand(u,p),h.get_promise()}},l.JsonUtil=function(){},l.JsonUtil.parseJson=function(e){return l._jQueryShim.parseJSON(e)},l.JsonUtil.toJson=function(e,t,i){t=t||!1,i=i||"";var n=[];return l.JsonUtil._serialize(e,t,i,n)},l.JsonUtil._indexOf=function(e,t,i){if(a.isValue(Array.prototype.indexOf))return e.indexOf(t,i);i=i||0;var n=e.length;if(n>0)for(var r=i;r<n;r++)if(e[r]===t)return r;return-1},l.JsonUtil._contains=function(e,t,i){return l.JsonUtil._indexOf(e,t,i)>=0},l.JsonUtil._serialize=function(e,t,i,n){if(l.JsonUtil._contains(n,e))throw Error.createError("The object contains recursive reference of sub-objects",null);if(a.isUndefined(e))return"undefined";if(null==e)return"null";var r=l._jQueryShim.type(e);if("number"===r||"boolean"===r)return e.toString();if("string"===r)return l.JsonUtil._escapeString(e);n.push(e);var o;i=i||"";var s=t?i+"\t":"",u=e.__json__||e.json;if(l._jQueryShim.isFunction(u)){if(o=u(e),e!==o){var _=l.JsonUtil._serialize(o,t,s,n);return n.pop(),_}}if(a.isValue(e.nodeType)&&a.isValue(e.cloneNode))throw Error.createError("Can't serialize DOM nodes",null);var c=t?" ":"",m=t?"\n":"";return l._jQueryShim.isArray(e)?l.JsonUtil._serializeArray(e,t,i,n,s,m):"function"===r?(n.pop(),null):l.JsonUtil._serializeGeneric(e,t,i,n,s,m,c)},l.JsonUtil._serializeGeneric=function(e,t,i,n,r,o,s){var u=e,_=new a.StringBuilder("{"),c=!1,m=u;for(var h in m){var p,d,f={key:h,value:m[h]};if("number"==typeof f.key)p='"'+f.key+'"';else{if("string"!=typeof f.key)continue;p=l.JsonUtil._escapeString(f.key)}d=l.JsonUtil._serialize(f.value,t,r,n),null!=d&&(c&&_.append(","),_.append(o+r+p+":"+s+d),c=!0)}return _.append(o+i+"}"),n.pop(),_.toString()},l.JsonUtil._serializeArray=function(e,t,i,n,r,o){for(var s=!1,u=new a.StringBuilder("["),_=e,c=0;c<_.length;c++){var m=_[c],h=l.JsonUtil._serialize(m,t,r,n);null==h&&(h="undefined"),s&&u.append(","),u.append(o+r+h),s=!0}return u.append(o+i+"]"),n.pop(),u.toString()},l.JsonUtil._escapeString=function(e){return e='"'+e.replace(/(["\\])/g,"\\$1")+'"',e=e.replace(new RegExp("[\f]","g"),"\\f"),e=e.replace(new RegExp("[\b]","g"),"\\b"),e=e.replace(new RegExp("[\n]","g"),"\\n"),e=e.replace(new RegExp("[\t]","g"),"\\t"),e=e.replace(new RegExp("[\r]","g"),"\\r")},o.registerNamespace("tableauSoftware"),l.$create_DataValue=function(e,t,i){var n={};return n.value=e,l._Utility.isNullOrEmpty(i)?n.formattedValue=t:n.formattedValue=i,n},l.$create_VizSize=function(e,t){var i={};return i.sheetSize=e,i.chromeHeight=t,i},l.$create_Point=function(e,t){var i={};return i.x=e,i.y=t,i},l.$create_Size=function(e,t){var i={};return i.width=e,i.height=t,i},l.$create_SheetSize=function(e,t,i){var n={};return n.behavior=e||"automatic",a.isValue(t)&&(n.minSize=t),a.isValue(i)&&(n.maxSize=i),n},r.CustomView=function(e){this._impl=e},r.CustomView.prototype={_impl:null,getWorkbook:function(){return this._impl.get__workbook()},getUrl:function(){return this._impl.get__url()},getName:function(){return this._impl.get__name()},setName:function(e){this._impl.set__name(e)},getOwnerName:function(){return this._impl.get__ownerName()},getAdvertised:function(){return this._impl.get__advertised()},setAdvertised:function(e){this._impl.set__advertised(e)},getDefault:function(){return this._impl.get__isDefault()},saveAsync:function(){return this._impl.saveAsync()}},l.CustomViewEvent=function(e,t,i){l.CustomViewEvent.initializeBase(this,[e,t]),this._context$1=new l._customViewEventContext(t._impl.get__workbookImpl(),i)},l.CustomViewEvent.prototype={_context$1:null,getCustomViewAsync:function(){var e=new l._Deferred,t=null;return a.isValue(this._context$1.get__customViewImpl())&&(t=this._context$1.get__customViewImpl().get__customView()),e.resolve(t),e.get_promise()}},l._customViewEventContext=function(e,t){l._customViewEventContext.initializeBase(this,[e,null]),this._customViewImpl$1=t},l._customViewEventContext.prototype={_customViewImpl$1:null,get__customViewImpl:function(){return this._customViewImpl$1}},r.Dashboard=function(e){r.Dashboard.initializeBase(this,[e])},r.Dashboard.prototype={_impl:null,getParentStoryPoint:function(){return this._impl.get_parentStoryPoint()},getObjects:function(){return this._impl.get_objects()._toApiCollection()},getWorksheets:function(){return this._impl.get_worksheets()._toApiCollection()}},r.DashboardObject=function(e,t,i){if("worksheet"===e._objectType&&a.isNullOrUndefined(i))throw l._TableauException.createInternalError("worksheet parameter is required for WORKSHEET objects");if("worksheet"!==e._objectType&&a.isValue(i))throw l._TableauException.createInternalError("worksheet parameter should be undefined for non-WORKSHEET objects");this._zoneInfo=e,this._dashboard=t,this._worksheet=i},r.DashboardObject.prototype={_zoneInfo:null,_dashboard:null,_worksheet:null,getObjectType:function(){return this._zoneInfo._objectType},getDashboard:function(){return this._dashboard},getWorksheet:function(){return this._worksheet},getPosition:function(){return this._zoneInfo._position},getSize:function(){return this._zoneInfo._size}},r.DataSource=function(e){this._impl=e},r.DataSource.prototype={_impl:null,getName:function(){return this._impl.get_name()},getFields:function(){return this._impl.get_fields()._toApiCollection()},getIsPrimary:function(){return this._impl.get_isPrimary()}},r.Field=function(e,t,i,n){this._dataSource=e,this._name=t,this._fieldRoleType=i,this._fieldAggrType=n},r.Field.prototype={_dataSource:null,_name:null,_fieldRoleType:null,_fieldAggrType:null,getDataSource:function(){return this._dataSource},getName:function(){return this._name},getRole:function(){return this._fieldRoleType},getAggregation:function(){return this._fieldAggrType}},r.CategoricalFilter=function(e,t){r.CategoricalFilter.initializeBase(this,[e,t]),this._initializeFromJson$1(t)},r.CategoricalFilter.prototype={_isExclude$1:!1,_appliedValues$1:null,getIsExcludeMode:function(){return this._isExclude$1},getAppliedValues:function(){return this._appliedValues$1},_updateFromJson:function(e){this._initializeFromJson$1(e)},_initializeFromJson$1:function(e){if(this._isExclude$1=e.isExclude,a.isValue(e.appliedValues)){this._appliedValues$1=[];for(var t=a.IEnumerator.getEnumerator(e.appliedValues);t.moveNext();){var i=t.current;this._appliedValues$1.push(l._Utility.getDataValue(i))}}}},r.Filter=function(e,t){this._worksheetImpl=e,this._initializeFromJson(t)},r.Filter._createFilter=function(e,t){switch(t.filterType){case"categorical":return new r.CategoricalFilter(e,t);case"relativedate":return new r.RelativeDateFilter(e,t);case"hierarchical":return new r.HierarchicalFilter(e,t);case"quantitative":return new r.QuantitativeFilter(e,t)}return null},r.Filter._processFiltersList=function(e,t){for(var i=new l._Collection,n=a.IEnumerator.getEnumerator(t.filters);n.moveNext();){var o=n.current,s=r.Filter._createFilter(e,o);i._add(o.caption,s)}return i},r.Filter.prototype={_worksheetImpl:null,_type:null,_caption:null,_field:null,_dataSourceName:null,_fieldRole:null,_fieldAggregation:null,getFilterType:function(){return this._type},getFieldName:function(){return this._caption},getWorksheet:function(){return this._worksheetImpl.get_worksheet()},getFieldAsync:function(){var e=new l._Deferred;if(null==this._field){var t=function(t){return e.reject(t),null},i=a.Delegate.create(this,function(t){return this._field=new r.Field(t,this._caption,this._fieldRole,this._fieldAggregation),e.resolve(this._field),null});this._worksheetImpl._getDataSourceAsync(this._dataSourceName).then(i,t)}else window.setTimeout(a.Delegate.create(this,function(){e.resolve(this._field)}),0);return e.get_promise()},_update:function(e){this._initializeFromJson(e),this._updateFromJson(e)},_addFieldParams:function(e){},_initializeFromJson:function(e){this._caption=e.caption,this._type=e.filterType,this._field=null,this._dataSourceName=e.dataSourceName,this._fieldRole=e.fieldRole||0,this._fieldAggregation=e.fieldAggregation||0}},l.FilterEvent=function(e,t,i,n,r){l.FilterEvent.initializeBase(this,[e,t,i]),this._filterCaption$2=r,this._context$2=new l._filterEventContext(t._impl.get__workbookImpl(),i,n,r)},l.FilterEvent.prototype={_filterCaption$2:null,_context$2:null,getFieldName:function(){return this._filterCaption$2},getFilterAsync:function(){return this._context$2.get__worksheetImpl()._getFilterAsync(this._context$2.get__filterFieldName(),null,null)}},l._filterEventContext=function(e,t,i,n){l._filterEventContext.initializeBase(this,[e,t]),this._fieldFieldName$1=i,this._filterCaption$1=n},l._filterEventContext.prototype={_fieldFieldName$1:null,_filterCaption$1:null,get__filterFieldName:function(){return this._fieldFieldName$1},get__filterCaption:function(){return this._filterCaption$1}},r.HierarchicalFilter=function(e,t){r.HierarchicalFilter.initializeBase(this,[e,t]),this._initializeFromJson$1(t)},r.HierarchicalFilter.prototype={_levels$1:0,_addFieldParams:function(e){e["api.filterHierarchicalLevels"]=this._levels$1},_updateFromJson:function(e){this._initializeFromJson$1(e)},_initializeFromJson$1:function(e){this._levels$1=e.levels}},r.QuantitativeFilter=function(e,t){r.QuantitativeFilter.initializeBase(this,[e,t]),this._initializeFromJson$1(t)},r.QuantitativeFilter.prototype={_domainMin$1:null,_domainMax$1:null,_min$1:null,_max$1:null,_includeNullValues$1:!1,getMin:function(){return this._min$1},getMax:function(){return this._max$1},getIncludeNullValues:function(){return this._includeNullValues$1},getDomainMin:function(){return this._domainMin$1},getDomainMax:function(){return this._domainMax$1},_updateFromJson:function(e){this._initializeFromJson$1(e)},_initializeFromJson$1:function(e){this._domainMin$1=l._Utility.getDataValue(e.domainMinValue),this._domainMax$1=l._Utility.getDataValue(e.domainMaxValue),this._min$1=l._Utility.getDataValue(e.minValue),this._max$1=l._Utility.getDataValue(e.maxValue),this._includeNullValues$1=e.includeNullValues}},r.RelativeDateFilter=function(e,t){r.RelativeDateFilter.initializeBase(this,[e,t]),this._initializeFromJson$1(t)},r.RelativeDateFilter.prototype={_periodType$1:null,_rangeType$1:null,_rangeN$1:0,getPeriod:function(){return this._periodType$1},getRange:function(){return this._rangeType$1},getRangeN:function(){return this._rangeN$1},_updateFromJson:function(e){this._initializeFromJson$1(e)},_initializeFromJson$1:function(e){a.isValue(e.periodType)&&(this._periodType$1=l._enums._normalizePeriodType(e.periodType,"periodType")),a.isValue(e.rangeType)&&(this._rangeType$1=l._enums._normalizeDateRangeType(e.rangeType,"rangeType")),a.isValue(e.rangeN)&&(this._rangeN$1=e.rangeN)}},l.FirstVizSizeKnownEvent=function(e,t,i){l.FirstVizSizeKnownEvent.initializeBase(this,[e,t]),this._vizSize$1=i},l.FirstVizSizeKnownEvent.prototype={_vizSize$1:null,getVizSize:function(){return this._vizSize$1}},r.Version=function(e,t,i,n){this._major=e,this._minor=t,this._patch=i,this._metadata=n||null},r.Version.getCurrent=function(){return r.Version._currentVersion},r.Version.prototype={_major:0,_minor:0,_patch:0,_metadata:null,getMajor:function(){return this._major},getMinor:function(){return this._minor},getPatch:function(){return this._patch},getMetadata:function(){return this._metadata},toString:function(){var e=this._major+"."+this._minor+"."+this._patch;return a.isValue(this._metadata)&&this._metadata.length>0&&(e+="-"+this._metadata),e}},l.VizResizeEvent=function(e,t,i){l.VizResizeEvent.initializeBase(this,[e,t]),this._availableSize$1=i},l.VizResizeEvent.prototype={_availableSize$1:null,getAvailableSize:function(){return this._availableSize$1}},r.Mark=function(e){this._impl=new l._markImpl(e)},r.Mark.prototype={_impl:null,getPairs:function(){return this._impl.get__clonedPairs()}},l.MarksEvent=function(e,t,i){l.MarksEvent.initializeBase(this,[e,t,i]),this._context$2=new l._marksEventContext(t._impl.get__workbookImpl(),i)},l.MarksEvent.prototype={_context$2:null,getMarksAsync:function(){var e=this._context$2.get__worksheetImpl();if(a.isValue(e.get_selectedMarks())){return(new l._Deferred).resolve(e.get_selectedMarks()._toApiCollection())}return e._getSelectedMarksAsync()}},l._marksEventContext=function(e,t){l._marksEventContext.initializeBase(this,[e,t])},r.Pair=function(e,t){this.fieldName=e,this.value=t,this.formattedValue=a.isValue(t)?t.toString():""},r.Pair.prototype={fieldName:null,value:null,formattedValue:null},r.Parameter=function(e){this._impl=e},r.Parameter.prototype={_impl:null,getName:function(){return this._impl.get__name()},getCurrentValue:function(){return this._impl.get__currentValue()},getDataType:function(){return this._impl.get__dataType()},getAllowableValuesType:function(){return this._impl.get__allowableValuesType()},getAllowableValues:function(){return this._impl.get__allowableValues()},getMinValue:function(){return this._impl.get__minValue()},getMaxValue:function(){return this._impl.get__maxValue()},getStepSize:function(){return this._impl.get__stepSize()},getDateStepPeriod:function(){return this._impl.get__dateStepPeriod()}},l.ParameterEvent=function(e,t,i){l.ParameterEvent.initializeBase(this,[e,t]),this._context$1=new l._parameterEventContext(t._impl.get__workbookImpl(),i)},l.ParameterEvent.prototype={_context$1:null,getParameterName:function(){return this._context$1.get__parameterName()},getParameterAsync:function(){return this._context$1.get__workbookImpl()._getSingleParameterAsync(this._context$1.get__parameterName())}},l._parameterEventContext=function(e,t){l._parameterEventContext.initializeBase(this,[e,null]),this._parameterName$1=t},l._parameterEventContext.prototype={_parameterName$1:null,get__parameterName:function(){return this._parameterName$1}},r.Sheet=function(e){l._Param.verifyValue(e,"sheetImpl"),this._impl=e},r.Sheet.prototype={_impl:null,getName:function(){return this._impl.get_name()},getIndex:function(){return this._impl.get_index()},getWorkbook:function(){return this._impl.get_workbookImpl().get_workbook()},getSize:function(){return this._impl.get_size()},getIsHidden:function(){return this._impl.get_isHidden()},getIsActive:function(){return this._impl.get_isActive()},getSheetType:function(){return this._impl.get_sheetType()},getUrl:function(){return this._impl.get_url()},changeSizeAsync:function(e){return this._impl.changeSizeAsync(e)}},r.SheetInfo=function(e){this._impl=e},r.SheetInfo.prototype={_impl:null,getName:function(){return this._impl.name},getSheetType:function(){return this._impl.sheetType},getSize:function(){return this._impl.size},getIndex:function(){return this._impl.index},getUrl:function(){return this._impl.url},getIsActive:function(){return this._impl.isActive},getIsHidden:function(){return this._impl.isHidden},getWorkbook:function(){return this._impl.workbook}},l.SheetSizeFactory=function(){},l.SheetSizeFactory.createAutomatic=function(){return l.$create_SheetSize("automatic",null,null)},l.SheetSizeFactory.fromSizeConstraints=function(e){var t=e.minHeight,i=e.minWidth,n=e.maxHeight,r=e.maxWidth,a="automatic",o=null,s=null;return t||i?n||r?n===t&&r===i?(a="exactly",o=l.$create_Size(i,t),s=l.$create_Size(i,t)):(a="range",o=l.$create_Size(i,t),s=l.$create_Size(r,n)):(a="atleast",o=l.$create_Size(i,t)):(n||r)&&(a="atmost",s=l.$create_Size(r,n)),l.$create_SheetSize(a,o,s)},r.Story=function(e){r.Story.initializeBase(this,[e])},r.Story.prototype={_impl:null,getActiveStoryPoint:function(){return this._impl.get_activeStoryPointImpl().get_storyPoint()},getStoryPointsInfo:function(){return this._impl.get_storyPointsInfo()},activatePreviousStoryPointAsync:function(){return this._impl.activatePreviousStoryPointAsync()},activateNextStoryPointAsync:function(){return this._impl.activateNextStoryPointAsync()},activateStoryPointAsync:function(e){return this._impl.activateStoryPointAsync(e)},revertStoryPointAsync:function(e){return this._impl.revertStoryPointAsync(e)}},r.StoryPoint=function(e){this._impl=e},r.StoryPoint.prototype={_impl:null,getCaption:function(){return this._impl.get_caption()},getContainedSheet:function(){return a.isValue(this._impl.get_containedSheetImpl())?this._impl.get_containedSheetImpl().get_sheet():null},getIndex:function(){return this._impl.get_index()},getIsActive:function(){return this._impl.get_isActive()},getIsUpdated:function(){return this._impl.get_isUpdated()},getParentStory:function(){return this._impl.get_parentStoryImpl().get_story()}},r.StoryPointInfo=function(e){this._impl=e},r.StoryPointInfo.prototype={_impl:null,getCaption:function(){return this._impl.caption},getIndex:function(){return this._impl.index},getIsActive:function(){return this._impl.isActive},getIsUpdated:function(){return this._impl.isUpdated},getParentStory:function(){return this._impl.parentStoryImpl.get_story()}},l.StoryPointSwitchEvent=function(e,t,i,n){l.StoryPointSwitchEvent.initializeBase(this,[e,t]),this._oldStoryPointInfo$1=i,this._newStoryPoint$1=n},l.StoryPointSwitchEvent.prototype={_oldStoryPointInfo$1:null,_newStoryPoint$1:null,getOldStoryPointInfo:function(){return this._oldStoryPointInfo$1},getNewStoryPoint:function(){return this._newStoryPoint$1}},l.TableauEvent=function(e,t){this._viz=t,this._eventName=e},l.TableauEvent.prototype={_viz:null,_eventName:null,getViz:function(){return this._viz},getEventName:function(){return this._eventName}},l.EventContext=function(e,t){this._workbookImpl=e,this._worksheetImpl=t},l.EventContext.prototype={_workbookImpl:null,_worksheetImpl:null,get__workbookImpl:function(){return this._workbookImpl},get__worksheetImpl:function(){return this._worksheetImpl}},l.TabSwitchEvent=function(e,t,i,n){l.TabSwitchEvent.initializeBase(this,[e,t]),this._oldName$1=i,this._newName$1=n},l.TabSwitchEvent.prototype={_oldName$1:null,_newName$1:null,getOldSheetName:function(){return this._oldName$1},getNewSheetName:function(){return this._newName$1}},r.Viz=function(e,t,i){var n=l._ApiObjectRegistry.getCrossDomainMessageRouter();this._impl=new l.VizImpl(n,this,e,t,i),this._impl._create()},r.Viz.getLastRequestMessage=function(){return l._ApiCommand.lastRequestMessage},r.Viz.getLastResponseMessage=function(){return l._ApiCommand.lastResponseMessage},r.Viz.getLastClientInfoResponseMessage=function(){return l._ApiCommand.lastClientInfoResponseMessage},r.Viz.prototype={_impl:null,getAreTabsHidden:function(){return this._impl.get__areTabsHidden()},getIsToolbarHidden:function(){return this._impl.get__isToolbarHidden()},getIsHidden:function(){return this._impl.get__isHidden()},getInstanceId:function(){return this._impl.get_instanceId()},getParentElement:function(){return this._impl.get__parentElement()},getUrl:function(){return this._impl.get__url()},getVizSize:function(){return this._impl.get__vizSize()},getWorkbook:function(){return this._impl.get__workbook()},getAreAutomaticUpdatesPaused:function(){return this._impl.get__areAutomaticUpdatesPaused()},getCurrentUrlAsync:function(){return this._impl.getCurrentUrlAsync()},addEventListener:function(e,t){this._impl.addEventListener(e,t)},removeEventListener:function(e,t){this._impl.removeEventListener(e,t)},dispose:function(){this._impl._dispose()},show:function(){this._impl._show()},hide:function(){this._impl._hide()},showExportDataDialog:function(e){this._impl._showExportDataDialog(e)},showExportCrossTabDialog:function(e){this._impl._showExportCrossTabDialog(e)},showExportImageDialog:function(){this._impl._showExportImageDialog()},showExportPDFDialog:function(){this._impl._showExportPDFDialog()},revertAllAsync:function(){return this._impl._revertAllAsync()},refreshDataAsync:function(){return this._impl._refreshDataAsync()},showShareDialog:function(){this._impl._showShareDialog()},showDownloadWorkbookDialog:function(){this._impl._showDownloadWorkbookDialog()},pauseAutomaticUpdatesAsync:function(){return this._impl._pauseAutomaticUpdatesAsync()},resumeAutomaticUpdatesAsync:function(){return this._impl._resumeAutomaticUpdatesAsync()},toggleAutomaticUpdatesAsync:function(){return this._impl._toggleAutomaticUpdatesAsync()},refreshSize:function(){this._impl._refreshSize()},setFrameSize:function(e,t){var i=e,n=t;l._Utility.isNumber(e)&&(i=e+"px"),l._Utility.isNumber(t)&&(n=t+"px"),this._impl._setFrameSizeAndUpdate(i,n)}},r.VizManager=function(){},r.VizManager.getVizs=function(){return l._VizManagerImpl.get__clonedVizs()},r.Workbook=function(e){this._workbookImpl=e},r.Workbook.prototype={_workbookImpl:null,getViz:function(){return this._workbookImpl.get_viz()},getPublishedSheetsInfo:function(){return this._workbookImpl.get_publishedSheets()._toApiCollection()},getName:function(){return this._workbookImpl.get_name()},getActiveSheet:function(){return this._workbookImpl.get_activeSheetImpl().get_sheet()},getActiveCustomView:function(){return this._workbookImpl.get_activeCustomView()},activateSheetAsync:function(e){return this._workbookImpl._setActiveSheetAsync(e)},revertAllAsync:function(){return this._workbookImpl._revertAllAsync()},getCustomViewsAsync:function(){return this._workbookImpl._getCustomViewsAsync()},showCustomViewAsync:function(e){return this._workbookImpl._showCustomViewAsync(e)},removeCustomViewAsync:function(e){return this._workbookImpl._removeCustomViewAsync(e)},rememberCustomViewAsync:function(e){return this._workbookImpl._rememberCustomViewAsync(e)},setActiveCustomViewAsDefaultAsync:function(){return this._workbookImpl._setActiveCustomViewAsDefaultAsync()},getParametersAsync:function(){return this._workbookImpl._getParametersAsync()},changeParameterValueAsync:function(e,t){return this._workbookImpl._changeParameterValueAsync(e,t)}},r.Worksheet=function(e){r.Worksheet.initializeBase(this,[e])},r.Worksheet.prototype={_impl:null,getParentDashboard:function(){return this._impl.get_parentDashboard()},getParentStoryPoint:function(){return this._impl.get_parentStoryPoint()},getDataSourcesAsync:function(){return this._impl._getDataSourcesAsync()},getFilterAsync:function(e,t){return this._impl._getFilterAsync(null,e,t)},getFiltersAsync:function(e){return this._impl._getFiltersAsync(e)},applyFilterAsync:function(e,t,i,n){return this._impl._applyFilterAsync(e,t,i,n)},clearFilterAsync:function(e){return this._impl._clearFilterAsync(e)},applyRangeFilterAsync:function(e,t){return this._impl._applyRangeFilterAsync(e,t)},applyRelativeDateFilterAsync:function(e,t){return this._impl._applyRelativeDateFilterAsync(e,t)},applyHierarchicalFilterAsync:function(e,t,i,n){return this._impl._applyHierarchicalFilterAsync(e,t,i,n)},clearSelectedMarksAsync:function(){return this._impl._clearSelectedMarksAsync()},selectMarksAsync:function(e,t,i){return this._impl._selectMarksAsync(e,t,i)},getSelectedMarksAsync:function(){return this._impl._getSelectedMarksAsync()}},l.WorksheetEvent=function(e,t,i){l.WorksheetEvent.initializeBase(this,[e,t]),this._worksheetImpl$1=i},l.WorksheetEvent.prototype={_worksheetImpl$1:null,getWorksheet:function(){return this._worksheetImpl$1.get_worksheet()}},l._jQueryShim=function(){},l._jQueryShim.isFunction=function(e){return"function"===l._jQueryShim.type(e)},l._jQueryShim.isArray=function(e){return a.isValue(Array.isArray)?Array.isArray(e):"array"===l._jQueryShim.type(e)},l._jQueryShim.type=function(e){return null==e?String(e):l._jQueryShim._class2type[l._jQueryShim._toString.call(e)]||"object"},l._jQueryShim.trim=function(e){return a.isValue(l._jQueryShim._trim)?null==e?"":l._jQueryShim._trim.call(e):null==e?"":e.replace(l._jQueryShim._trimLeft,"").replace(l._jQueryShim._trimRight,"")},l._jQueryShim.parseJSON=function(e){if("string"!=typeof e||a.isNullOrUndefined(e))return null;if(e=l._jQueryShim.trim(e),window.JSON&&window.JSON.parse)return window.JSON.parse(e);if(l._jQueryShim._rvalidchars.test(e.replace(l._jQueryShim._rvalidescape,"@").replace(l._jQueryShim._rvalidtokens,"]").replace(l._jQueryShim._rvalidbraces,"")))return new Function("return "+e)();throw new Error("Invalid JSON: "+e)},l._ApiCommand.registerClass("tab._ApiCommand"),l._ApiServerResultParser.registerClass("tab._ApiServerResultParser"),l._ApiServerNotification.registerClass("tab._ApiServerNotification"),l._CommandReturnHandler.registerClass("tab._CommandReturnHandler"),l._crossDomainMessageRouter.registerClass("tab._crossDomainMessageRouter",null,l.ICrossDomainMessageRouter),l._doNothingCrossDomainHandler.registerClass("tab._doNothingCrossDomainHandler",null,l.ICrossDomainMessageHandler),l.CrossDomainMessagingOptions.registerClass("tab.CrossDomainMessagingOptions"),l._enums.registerClass("tab._enums"),l._ApiBootstrap.registerClass("tab._ApiBootstrap"),l._ApiObjectRegistry.registerClass("tab._ApiObjectRegistry"),l._CustomViewImpl.registerClass("tab._CustomViewImpl"),l._SheetImpl.registerClass("tab._SheetImpl"),l._DashboardImpl.registerClass("tab._DashboardImpl",l._SheetImpl),l._DataSourceImpl.registerClass("tab._DataSourceImpl"),l._deferredUtil.registerClass("tab._deferredUtil"),l._CollectionImpl.registerClass("tab._CollectionImpl"),l._DeferredImpl.registerClass("tab._DeferredImpl"),l._PromiseImpl.registerClass("tab._PromiseImpl"),l._markImpl.registerClass("tab._markImpl"),l._Param.registerClass("tab._Param"),l._parameterImpl.registerClass("tab._parameterImpl"),l._StoryImpl.registerClass("tab._StoryImpl",l._SheetImpl),l._StoryPointImpl.registerClass("tab._StoryPointImpl"),l.StoryPointInfoImplUtil.registerClass("tab.StoryPointInfoImplUtil"),l._TableauException.registerClass("tab._TableauException"),l._Utility.registerClass("tab._Utility"),l.VizImpl.registerClass("tab.VizImpl",null,l.ICrossDomainMessageHandler),l._VizManagerImpl.registerClass("tab._VizManagerImpl"),l._VizParameters.registerClass("tab._VizParameters"),l._WorkbookImpl.registerClass("tab._WorkbookImpl"),l._WorksheetImpl.registerClass("tab._WorksheetImpl",l._SheetImpl),l.JsonUtil.registerClass("tab.JsonUtil"),r.CustomView.registerClass("tableauSoftware.CustomView"),l.TableauEvent.registerClass("tab.TableauEvent"),l.CustomViewEvent.registerClass("tab.CustomViewEvent",l.TableauEvent),l.EventContext.registerClass("tab.EventContext"),l._customViewEventContext.registerClass("tab._customViewEventContext",l.EventContext),r.Sheet.registerClass("tableauSoftware.Sheet"),r.Dashboard.registerClass("tableauSoftware.Dashboard",r.Sheet),r.DashboardObject.registerClass("tableauSoftware.DashboardObject"),r.DataSource.registerClass("tableauSoftware.DataSource"),r.Field.registerClass("tableauSoftware.Field"),r.Filter.registerClass("tableauSoftware.Filter"),r.CategoricalFilter.registerClass("tableauSoftware.CategoricalFilter",r.Filter),l.WorksheetEvent.registerClass("tab.WorksheetEvent",l.TableauEvent),l.FilterEvent.registerClass("tab.FilterEvent",l.WorksheetEvent),l._filterEventContext.registerClass("tab._filterEventContext",l.EventContext),r.HierarchicalFilter.registerClass("tableauSoftware.HierarchicalFilter",r.Filter),r.QuantitativeFilter.registerClass("tableauSoftware.QuantitativeFilter",r.Filter),r.RelativeDateFilter.registerClass("tableauSoftware.RelativeDateFilter",r.Filter),l.FirstVizSizeKnownEvent.registerClass("tab.FirstVizSizeKnownEvent",l.TableauEvent),r.Version.registerClass("tableauSoftware.Version"),l.VizResizeEvent.registerClass("tab.VizResizeEvent",l.TableauEvent),r.Mark.registerClass("tableauSoftware.Mark"),l.MarksEvent.registerClass("tab.MarksEvent",l.WorksheetEvent),l._marksEventContext.registerClass("tab._marksEventContext",l.EventContext),r.Pair.registerClass("tableauSoftware.Pair"),r.Parameter.registerClass("tableauSoftware.Parameter"),l.ParameterEvent.registerClass("tab.ParameterEvent",l.TableauEvent),l._parameterEventContext.registerClass("tab._parameterEventContext",l.EventContext),r.SheetInfo.registerClass("tableauSoftware.SheetInfo"),l.SheetSizeFactory.registerClass("tab.SheetSizeFactory"),r.Story.registerClass("tableauSoftware.Story",r.Sheet),r.StoryPoint.registerClass("tableauSoftware.StoryPoint"),r.StoryPointInfo.registerClass("tableauSoftware.StoryPointInfo");l.StoryPointSwitchEvent.registerClass("tab.StoryPointSwitchEvent",l.TableauEvent),l.TabSwitchEvent.registerClass("tab.TabSwitchEvent",l.TableauEvent),r.Viz.registerClass("tableauSoftware.Viz"),r.VizManager.registerClass("tableauSoftware.VizManager"),r.Workbook.registerClass("tableauSoftware.Workbook"),r.Worksheet.registerClass("tableauSoftware.Worksheet",r.Sheet),l._jQueryShim.registerClass("tab._jQueryShim"),l._ApiCommand.crossDomainEventNotificationId="xdomainSourceId",l._ApiCommand.lastRequestMessage=null,l._ApiCommand.lastResponseMessage=null,l._ApiCommand.lastClientInfoResponseMessage=null,l._ApiObjectRegistry._creationRegistry=null,l._ApiObjectRegistry._singletonInstanceRegistry=null,l._SheetImpl.noZoneId=4294967295,l._VizManagerImpl._vizs=[],l._WorksheetImpl._regexHierarchicalFieldName$1=new RegExp("\\[[^\\]]+\\]\\.","g"),r.Version._currentVersion=new r.Version(2,0,0,null),l._jQueryShim._class2type={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},l._jQueryShim._trim=String.prototype.trim,l._jQueryShim._toString=Object.prototype.toString,l._jQueryShim._trimLeft=new RegExp("^[\\s\\xA0]+"),l._jQueryShim._trimRight=new RegExp("[\\s\\xA0]+$"),l._jQueryShim._rvalidchars=new RegExp("^[\\],:{}\\s]*$"),l._jQueryShim._rvalidescape=new RegExp('\\\\(?:["\\\\\\/bfnrt]|u[0-9a-fA-F]{4})',"g"),l._jQueryShim._rvalidtokens=new RegExp('"[^"\\\\\\n\\r]*"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?',"g"),l._jQueryShim._rvalidbraces=new RegExp("(?:^|:|,)(?:\\s*\\[)+","g"),r.Promise=l._PromiseImpl,l._Deferred=l._DeferredImpl,l._Collection=l._CollectionImpl,r.DashboardObjectType={BLANK:"blank",WORKSHEET:"worksheet",QUICK_FILTER:"quickFilter",PARAMETER_CONTROL:"parameterControl",PAGE_FILTER:"pageFilter",LEGEND:"legend",TITLE:"title",TEXT:"text",IMAGE:"image",WEB_PAGE:"webPage"},r.FilterType={CATEGORICAL:"categorical",QUANTITATIVE:"quantitative",HIERARCHICAL:"hierarchical",RELATIVEDATE:"relativedate"},r.ParameterDataType={FLOAT:"float",INTEGER:"integer",STRING:"string",BOOLEAN:"boolean",DATE:"date",DATETIME:"datetime"},r.ParameterAllowableValuesType={ALL:"all",LIST:"list",RANGE:"range"},r.PeriodType={YEAR:"year",QUARTER:"quarter",MONTH:"month",WEEK:"week",DAY:"day",HOUR:"hour",MINUTE:"minute",SECOND:"second"},r.DateRangeType={LAST:"last",LASTN:"lastn",NEXT:"next",NEXTN:"nextn",CURR:"curr",TODATE:"todate"},r.SheetSizeBehavior={AUTOMATIC:"automatic",EXACTLY:"exactly",RANGE:"range",ATLEAST:"atleast",ATMOST:"atmost"},r.SheetType={WORKSHEET:"worksheet",DASHBOARD:"dashboard",STORY:"story"},r.FilterUpdateType={ALL:"all",REPLACE:"replace",ADD:"add",REMOVE:"remove"},r.SelectionUpdateType={REPLACE:"replace",ADD:"add",REMOVE:"remove"},r.NullOption={NULL_VALUES:"nullValues",NON_NULL_VALUES:"nonNullValues",ALL_VALUES:"allValues"},r.ErrorCode={INTERNAL_ERROR:"internalError",SERVER_ERROR:"serverError",INVALID_AGGREGATION_FIELD_NAME:"invalidAggregationFieldName",INVALID_PARAMETER:"invalidParameter",INVALID_URL:"invalidUrl",STALE_DATA_REFERENCE:"staleDataReference",VIZ_ALREADY_IN_MANAGER:"vizAlreadyInManager",NO_URL_OR_PARENT_ELEMENT_NOT_FOUND:"noUrlOrParentElementNotFound",INVALID_FILTER_FIELDNAME:"invalidFilterFieldName",INVALID_FILTER_FIELDVALUE:"invalidFilterFieldValue",INVALID_FILTER_FIELDNAME_OR_VALUE:"invalidFilterFieldNameOrValue",FILTER_CANNOT_BE_PERFORMED:"filterCannotBePerformed",NOT_ACTIVE_SHEET:"notActiveSheet",INVALID_CUSTOM_VIEW_NAME:"invalidCustomViewName",MISSING_RANGEN_FOR_RELATIVE_DATE_FILTERS:"missingRangeNForRelativeDateFilters",MISSING_MAX_SIZE:"missingMaxSize",MISSING_MIN_SIZE:"missingMinSize",MISSING_MINMAX_SIZE:"missingMinMaxSize",INVALID_SIZE:"invalidSize",INVALID_SIZE_BEHAVIOR_ON_WORKSHEET:"invalidSizeBehaviorOnWorksheet",SHEET_NOT_IN_WORKBOOK:"sheetNotInWorkbook",INDEX_OUT_OF_RANGE:"indexOutOfRange",DOWNLOAD_WORKBOOK_NOT_ALLOWED:"downloadWorkbookNotAllowed",NULL_OR_EMPTY_PARAMETER:"nullOrEmptyParameter",BROWSER_NOT_CAPABLE:"browserNotCapable",UNSUPPORTED_EVENT_NAME:"unsupportedEventName",INVALID_DATE_PARAMETER:"invalidDateParameter",INVALID_SELECTION_FIELDNAME:"invalidSelectionFieldName",INVALID_SELECTION_VALUE:"invalidSelectionValue",INVALID_SELECTION_DATE:"invalidSelectionDate",NO_URL_FOR_HIDDEN_WORKSHEET:"noUrlForHiddenWorksheet",MAX_VIZ_RESIZE_ATTEMPTS:"maxVizResizeAttempts"},r.TableauEventName={CUSTOM_VIEW_LOAD:"customviewload",CUSTOM_VIEW_REMOVE:"customviewremove",CUSTOM_VIEW_SAVE:"customviewsave",CUSTOM_VIEW_SET_DEFAULT:"customviewsetdefault",FILTER_CHANGE:"filterchange",FIRST_INTERACTIVE:"firstinteractive",FIRST_VIZ_SIZE_KNOWN:"firstvizsizeknown",MARKS_SELECTION:"marksselection",PARAMETER_VALUE_CHANGE:"parametervaluechange",STORY_POINT_SWITCH:"storypointswitch",TAB_SWITCH:"tabswitch",VIZ_RESIZE:"vizresize"},r.FieldRoleType={DIMENSION:"dimension",MEASURE:"measure",UNKNOWN:"unknown"},r.FieldAggregationType={SUM:"SUM",AVG:"AVG",MIN:"MIN",MAX:"MAX",STDEV:"STDEV",STDEVP:"STDEVP",VAR:"VAR",VARP:"VARP",COUNT:"COUNT",COUNTD:"COUNTD",MEDIAN:"MEDIAN",ATTR:"ATTR",NONE:"NONE",PERCENTILE:"PERCENTILE",YEAR:"YEAR",QTR:"QTR",MONTH:"MONTH",DAY:"DAY",HOUR:"HOUR",MINUTE:"MINUTE",SECOND:"SECOND",WEEK:"WEEK",WEEKDAY:"WEEKDAY",MONTHYEAR:"MONTHYEAR",MDY:"MDY",END:"END",TRUNC_YEAR:"TRUNC_YEAR",TRUNC_QTR:"TRUNC_QTR",TRUNC_MONTH:"TRUNC_MONTH",TRUNC_WEEK:"TRUNC_WEEK",TRUNC_DAY:"TRUNC_DAY",TRUNC_HOUR:"TRUNC_HOUR",TRUNC_MINUTE:"TRUNC_MINUTE",TRUNC_SECOND:"TRUNC_SECOND",QUART1:"QUART1",QUART3:"QUART3",SKEWNESS:"SKEWNESS",KURTOSIS:"KURTOSIS",INOUT:"INOUT",SUM_XSQR:"SUM_XSQR",USER:"USER"},r.ToolbarPosition={TOP:"top",BOTTOM:"bottom"},function(){for(var e in s)if(s.hasOwnProperty(e)){var t=s[e],i=t.isPrototype?o.prototype:o;t.func?i[e]=t.func:delete i[e]}}(),l._ApiBootstrap.initialize()}(),e.exports=r}]);